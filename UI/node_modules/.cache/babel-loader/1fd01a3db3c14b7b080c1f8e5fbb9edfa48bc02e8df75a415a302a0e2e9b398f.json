{"ast":null,"code":"import React,{useEffect,useState}from'react';import{fetchAuthSession}from'aws-amplify/auth';import'./Gallery.css';// Media thumbnail component (copied from Search.js with enhancements)\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MediaThumbnail=_ref=>{let{url,fileType,tags,onMediaClick,width=200}=_ref;const[imageError,setImageError]=useState(false);const[mediaType,setMediaType]=useState(null);// Detect media type from file_type or URL\nconst detectMediaType=(url,fileType)=>{// First try to use the file_type from API response\nif(fileType){if(fileType.startsWith('image/'))return'image';if(fileType.startsWith('video/'))return'video';if(fileType.startsWith('audio/'))return'audio';}// Fallback to URL detection\nif(!url)return'unknown';const lowerUrl=url.toLowerCase();if(lowerUrl.includes('.jpg')||lowerUrl.includes('.jpeg')||lowerUrl.includes('.png')||lowerUrl.includes('.gif')||lowerUrl.includes('.webp')||lowerUrl.includes('.bmp')){return'image';}if(lowerUrl.includes('.mp4')||lowerUrl.includes('.mov')||lowerUrl.includes('.avi')||lowerUrl.includes('.mkv')||lowerUrl.includes('.webm')||lowerUrl.includes('.quicktime')){return'video';}if(lowerUrl.includes('.mp3')||lowerUrl.includes('.wav')||lowerUrl.includes('.ogg')||lowerUrl.includes('.m4a')||lowerUrl.includes('.flac')||lowerUrl.includes('.aac')){return'audio';}return'unknown';};const currentMediaType=mediaType||detectMediaType(url,fileType);const handleImageError=()=>{setImageError(true);setMediaType(detectMediaType(url,fileType));};const renderImageThumbnail=()=>/*#__PURE__*/_jsx(\"img\",{src:url,alt:\"thumbnail\",style:{width:'100%',height:200,objectFit:'cover',cursor:'pointer',border:'1px solid #ddd',borderRadius:'4px',transition:'transform 0.2s ease'},onClick:()=>onMediaClick(url),onMouseOver:e=>e.target.style.transform='scale(1.02)',onMouseOut:e=>e.target.style.transform='scale(1)',onError:handleImageError});const renderVideoThumbnail=()=>/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',height:200,border:'1px solid #ddd',borderRadius:'4px',cursor:'pointer',position:'relative',backgroundColor:'#f5f5f5',display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',transition:'transform 0.2s ease',backgroundImage:'linear-gradient(45deg, #f0f0f0 25%, transparent 25%), linear-gradient(-45deg, #f0f0f0 25%, transparent 25%)',backgroundSize:'20px 20px'},onClick:()=>onMediaClick(url),onMouseOver:e=>e.target.style.transform='scale(1.02)',onMouseOut:e=>e.target.style.transform='scale(1)',children:[/*#__PURE__*/_jsx(\"svg\",{width:\"48\",height:\"48\",viewBox:\"0 0 24 24\",fill:\"#666\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M8 5v14l11-7z\"})}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'14px',color:'#666',marginTop:'8px',fontWeight:'bold'},children:\"VIDEO\"})]});const renderAudioThumbnail=()=>/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',height:200,border:'1px solid #ddd',borderRadius:'4px',cursor:'pointer',position:'relative',backgroundColor:'#f0f8ff',display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',transition:'transform 0.2s ease'},onClick:()=>onMediaClick(url),onMouseOver:e=>e.target.style.transform='scale(1.02)',onMouseOut:e=>e.target.style.transform='scale(1)',children:[/*#__PURE__*/_jsx(\"svg\",{width:\"48\",height:\"48\",viewBox:\"0 0 24 24\",fill:\"#4a90e2\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z\"})}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'14px',color:'#4a90e2',marginTop:'8px',fontWeight:'bold'},children:\"AUDIO\"}),/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',bottom:'15px',display:'flex',alignItems:'end',gap:'2px'},children:[12,20,8,16,24,10,18,14,22,6,16,12].map((height,i)=>/*#__PURE__*/_jsx(\"div\",{style:{width:'3px',height:\"\".concat(height,\"px\"),backgroundColor:'#4a90e2',borderRadius:'1px',opacity:0.7}},i))})]});const renderUnknownThumbnail=()=>/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',height:200,border:'1px solid #ddd',borderRadius:'4px',cursor:'pointer',backgroundColor:'#f5f5f5',display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',transition:'transform 0.2s ease'},onClick:()=>onMediaClick(url),onMouseOver:e=>e.target.style.transform='scale(1.02)',onMouseOut:e=>e.target.style.transform='scale(1)',children:[/*#__PURE__*/_jsx(\"svg\",{width:\"48\",height:\"48\",viewBox:\"0 0 24 24\",fill:\"#999\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z\"})}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'14px',color:'#999',marginTop:'8px',fontWeight:'bold'},children:\"FILE\"})]});// Render based on media type\nif(!imageError&&(currentMediaType==='image'||currentMediaType==='unknown')){return renderImageThumbnail();}else if(currentMediaType==='video'){return renderVideoThumbnail();}else if(currentMediaType==='audio'){return renderAudioThumbnail();}else{return renderUnknownThumbnail();}};const Gallery=()=>{const[mediaItems,setMediaItems]=useState([]);const[searchTag,setSearchTag]=useState('');const[error,setError]=useState('');const[loading,setLoading]=useState(false);const[totalCount,setTotalCount]=useState(0);const apiBase='https://5myucif3s8.execute-api.us-east-1.amazonaws.com/dev';useEffect(()=>{const fetchMedia=async()=>{setLoading(true);try{var _tokens$idToken;const{tokens}=await fetchAuthSession();const idToken=tokens===null||tokens===void 0?void 0:(_tokens$idToken=tokens.idToken)===null||_tokens$idToken===void 0?void 0:_tokens$idToken.toString();if(!idToken){throw new Error('Authentication token not available');}const res=await fetch(\"\".concat(apiBase,\"/show-gallery\"),{method:'GET',headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(idToken)}});if(!res.ok){const text=await res.text();throw new Error(\"Fetch failed: \".concat(res.status,\" \").concat(text));}const data=await res.json();console.log('Gallery API response:',data);// Transform the grouped gallery data into flat array\nconst allItems=transformGalleryData(data.gallery||{});setMediaItems(allItems);setTotalCount(data.total_count||allItems.length);setError('');}catch(err){console.error('Error fetching media:',err);setError('Failed to load media files.');}finally{setLoading(false);}};fetchMedia();},[]);// Transform the grouped gallery response into format for display\nconst transformGalleryData=gallery=>{const allItems=[];// Process all file types\n['images','audio','video','other'].forEach(fileType=>{if(gallery[fileType]&&Array.isArray(gallery[fileType])){gallery[fileType].forEach(item=>{// Transform tags from object format {crow: 2, pigeon: 1} to array format [\"crow (2)\", \"pigeon (1)\"]\nconst tagsArray=transformTags(item.tags||{});allItems.push({url:item.url,file_type:item.file_type,file_id:item.file_id,upload_date:item.upload_date,tags:tagsArray,tagsObject:item.tags||{}// Keep original for filtering\n});});}});return allItems;};// Convert tags object to array format for display\nconst transformTags=tagsObject=>{if(!tagsObject||typeof tagsObject!=='object'){return[];}return Object.entries(tagsObject).map(_ref2=>{let[species,count]=_ref2;return count>1?\"\".concat(species,\" (\").concat(count,\")\"):species;});};// Enhanced media click handler (copied from Search.js)\nconst handleMediaClick=async mediaUrl=>{try{setLoading(true);setError('');console.log('Opening media:',mediaUrl);// For images that are thumbnails, try to get original\nif(mediaUrl.includes('/thumbnails/')){try{var _tokens$idToken2;const{tokens}=await fetchAuthSession();const token=tokens===null||tokens===void 0?void 0:(_tokens$idToken2=tokens.idToken)===null||_tokens$idToken2===void 0?void 0:_tokens$idToken2.toString();const response=await fetch(\"\".concat(apiBase,\"/search/by-thumbnail-url?thumbnail_url=\").concat(encodeURIComponent(mediaUrl)),{method:'GET',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'}});if(response.ok){const data=await response.json();if(data.links&&data.links.length>0){window.open(data.links[0],'_blank');return;}}}catch(err){console.error('API lookup failed, trying fallback:',err);}// Fallback: construct original URL\nconst originalUrl=mediaUrl.replace('/thumbnails/','/');window.open(originalUrl,'_blank');}else{// It's already the original URL\nwindow.open(mediaUrl,'_blank');}}catch(err){console.error('Media click failed:',err);setError(\"Error opening media: \".concat(err.message));}finally{setLoading(false);}};// Filter items based on search tag\nconst filteredItems=searchTag?mediaItems.filter(item=>{var _item$tags;// Search in both the display tags and original tags object\nconst searchLower=searchTag.toLowerCase();// Check display tags\nconst matchesDisplayTags=(_item$tags=item.tags)===null||_item$tags===void 0?void 0:_item$tags.some(tag=>tag.toLowerCase().includes(searchLower));// Check original tags object keys\nconst matchesOriginalTags=Object.keys(item.tagsObject||{}).some(species=>species.toLowerCase().includes(searchLower));return matchesDisplayTags||matchesOriginalTags;}):mediaItems;return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Gallery\"}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'20px'},children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Filter by bird species...\",value:searchTag,onChange:e=>setSearchTag(e.target.value),className:\"search-input\",style:{padding:'12px',width:'300px',border:'2px solid #ddd',borderRadius:'6px',fontSize:'14px'}})}),loading&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#1976d2',backgroundColor:'#e3f2fd',padding:'10px',borderRadius:'4px',marginBottom:'20px'},children:\"Loading gallery...\"}),error&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#d32f2f',backgroundColor:'#ffebee',padding:'12px',borderRadius:'4px',marginBottom:'20px',borderLeft:'4px solid #d32f2f'},children:error}),/*#__PURE__*/_jsx(\"div\",{className:\"gallery-grid\",children:filteredItems.length===0&&!loading?/*#__PURE__*/_jsx(\"p\",{children:\"No matching files found.\"}):filteredItems.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"gallery-tile\",children:[/*#__PURE__*/_jsx(MediaThumbnail,{url:item.url,fileType:item.file_type,tags:item.tags,onMediaClick:handleMediaClick}),item.tags&&item.tags.length>0&&/*#__PURE__*/_jsx(\"ul\",{children:item.tags.map((tag,i)=>/*#__PURE__*/_jsx(\"li\",{children:tag},i))}),item.upload_date&&/*#__PURE__*/_jsx(\"div\",{className:\"upload-date\",children:new Date(item.upload_date).toLocaleDateString()})]},item.file_id||index))}),mediaItems.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"file-count\",children:[\"Showing \",filteredItems.length,\" of \",totalCount,\" files\"]})]});};export default Gallery;","map":{"version":3,"names":["React","useEffect","useState","fetchAuthSession","jsx","_jsx","jsxs","_jsxs","MediaThumbnail","_ref","url","fileType","tags","onMediaClick","width","imageError","setImageError","mediaType","setMediaType","detectMediaType","startsWith","lowerUrl","toLowerCase","includes","currentMediaType","handleImageError","renderImageThumbnail","src","alt","style","height","objectFit","cursor","border","borderRadius","transition","onClick","onMouseOver","e","target","transform","onMouseOut","onError","renderVideoThumbnail","position","backgroundColor","display","flexDirection","alignItems","justifyContent","backgroundImage","backgroundSize","children","viewBox","fill","d","fontSize","color","marginTop","fontWeight","renderAudioThumbnail","bottom","gap","map","i","concat","opacity","renderUnknownThumbnail","Gallery","mediaItems","setMediaItems","searchTag","setSearchTag","error","setError","loading","setLoading","totalCount","setTotalCount","apiBase","fetchMedia","_tokens$idToken","tokens","idToken","toString","Error","res","fetch","method","headers","Authorization","ok","text","status","data","json","console","log","allItems","transformGalleryData","gallery","total_count","length","err","forEach","Array","isArray","item","tagsArray","transformTags","push","file_type","file_id","upload_date","tagsObject","Object","entries","_ref2","species","count","handleMediaClick","mediaUrl","_tokens$idToken2","token","response","encodeURIComponent","links","window","open","originalUrl","replace","message","filteredItems","filter","_item$tags","searchLower","matchesDisplayTags","some","tag","matchesOriginalTags","keys","padding","marginBottom","type","placeholder","value","onChange","className","borderLeft","index","Date","toLocaleDateString"],"sources":["/Users/saisaran/Desktop/BirdTag/UI/src/Gallery.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { fetchAuthSession } from 'aws-amplify/auth';\r\nimport './Gallery.css';\r\n\r\n// Media thumbnail component (copied from Search.js with enhancements)\r\nconst MediaThumbnail = ({ url, fileType, tags, onMediaClick, width = 200 }) => {\r\n  const [imageError, setImageError] = useState(false);\r\n  const [mediaType, setMediaType] = useState(null);\r\n\r\n  // Detect media type from file_type or URL\r\n  const detectMediaType = (url, fileType) => {\r\n    // First try to use the file_type from API response\r\n    if (fileType) {\r\n      if (fileType.startsWith('image/')) return 'image';\r\n      if (fileType.startsWith('video/')) return 'video';  \r\n      if (fileType.startsWith('audio/')) return 'audio';\r\n    }\r\n    \r\n    // Fallback to URL detection\r\n    if (!url) return 'unknown';\r\n    \r\n    const lowerUrl = url.toLowerCase();\r\n    \r\n    if (lowerUrl.includes('.jpg') || lowerUrl.includes('.jpeg') || \r\n        lowerUrl.includes('.png') || lowerUrl.includes('.gif') || \r\n        lowerUrl.includes('.webp') || lowerUrl.includes('.bmp')) {\r\n      return 'image';\r\n    }\r\n    \r\n    if (lowerUrl.includes('.mp4') || lowerUrl.includes('.mov') || \r\n        lowerUrl.includes('.avi') || lowerUrl.includes('.mkv') || \r\n        lowerUrl.includes('.webm') || lowerUrl.includes('.quicktime')) {\r\n      return 'video';\r\n    }\r\n    \r\n    if (lowerUrl.includes('.mp3') || lowerUrl.includes('.wav') || \r\n        lowerUrl.includes('.ogg') || lowerUrl.includes('.m4a') || \r\n        lowerUrl.includes('.flac') || lowerUrl.includes('.aac')) {\r\n      return 'audio';\r\n    }\r\n    \r\n    return 'unknown';\r\n  };\r\n\r\n  const currentMediaType = mediaType || detectMediaType(url, fileType);\r\n\r\n  const handleImageError = () => {\r\n    setImageError(true);\r\n    setMediaType(detectMediaType(url, fileType));\r\n  };\r\n\r\n  const renderImageThumbnail = () => (\r\n    <img\r\n      src={url}\r\n      alt=\"thumbnail\"\r\n      style={{\r\n        width: '100%',\r\n        height: 200,\r\n        objectFit: 'cover',\r\n        cursor: 'pointer',\r\n        border: '1px solid #ddd',\r\n        borderRadius: '4px',\r\n        transition: 'transform 0.2s ease'\r\n      }}\r\n      onClick={() => onMediaClick(url)}\r\n      onMouseOver={(e) => e.target.style.transform = 'scale(1.02)'}\r\n      onMouseOut={(e) => e.target.style.transform = 'scale(1)'}\r\n      onError={handleImageError}\r\n    />\r\n  );\r\n\r\n  const renderVideoThumbnail = () => (\r\n    <div\r\n      style={{\r\n        width: '100%',\r\n        height: 200,\r\n        border: '1px solid #ddd',\r\n        borderRadius: '4px',\r\n        cursor: 'pointer',\r\n        position: 'relative',\r\n        backgroundColor: '#f5f5f5',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        transition: 'transform 0.2s ease',\r\n        backgroundImage: 'linear-gradient(45deg, #f0f0f0 25%, transparent 25%), linear-gradient(-45deg, #f0f0f0 25%, transparent 25%)',\r\n        backgroundSize: '20px 20px'\r\n      }}\r\n      onClick={() => onMediaClick(url)}\r\n      onMouseOver={(e) => e.target.style.transform = 'scale(1.02)'}\r\n      onMouseOut={(e) => e.target.style.transform = 'scale(1)'}\r\n    >\r\n      <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"#666\">\r\n        <path d=\"M8 5v14l11-7z\"/>\r\n      </svg>\r\n      <div style={{\r\n        fontSize: '14px',\r\n        color: '#666',\r\n        marginTop: '8px',\r\n        fontWeight: 'bold'\r\n      }}>\r\n        VIDEO\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderAudioThumbnail = () => (\r\n    <div\r\n      style={{\r\n        width: '100%',\r\n        height: 200,\r\n        border: '1px solid #ddd',\r\n        borderRadius: '4px',\r\n        cursor: 'pointer',\r\n        position: 'relative',\r\n        backgroundColor: '#f0f8ff',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        transition: 'transform 0.2s ease'\r\n      }}\r\n      onClick={() => onMediaClick(url)}\r\n      onMouseOver={(e) => e.target.style.transform = 'scale(1.02)'}\r\n      onMouseOut={(e) => e.target.style.transform = 'scale(1)'}\r\n    >\r\n      <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"#4a90e2\">\r\n        <path d=\"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z\"/>\r\n      </svg>\r\n      <div style={{\r\n        fontSize: '14px',\r\n        color: '#4a90e2',\r\n        marginTop: '8px',\r\n        fontWeight: 'bold'\r\n      }}>\r\n        AUDIO\r\n      </div>\r\n      \r\n      {/* Audio waveform visualization */}\r\n      <div style={{\r\n        position: 'absolute',\r\n        bottom: '15px',\r\n        display: 'flex',\r\n        alignItems: 'end',\r\n        gap: '2px'\r\n      }}>\r\n        {[12, 20, 8, 16, 24, 10, 18, 14, 22, 6, 16, 12].map((height, i) => (\r\n          <div\r\n            key={i}\r\n            style={{\r\n              width: '3px',\r\n              height: `${height}px`,\r\n              backgroundColor: '#4a90e2',\r\n              borderRadius: '1px',\r\n              opacity: 0.7\r\n            }}\r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderUnknownThumbnail = () => (\r\n    <div\r\n      style={{\r\n        width: '100%',\r\n        height: 200,\r\n        border: '1px solid #ddd',\r\n        borderRadius: '4px',\r\n        cursor: 'pointer',\r\n        backgroundColor: '#f5f5f5',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        transition: 'transform 0.2s ease'\r\n      }}\r\n      onClick={() => onMediaClick(url)}\r\n      onMouseOver={(e) => e.target.style.transform = 'scale(1.02)'}\r\n      onMouseOut={(e) => e.target.style.transform = 'scale(1)'}\r\n    >\r\n      <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"#999\">\r\n        <path d=\"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z\"/>\r\n      </svg>\r\n      <div style={{\r\n        fontSize: '14px',\r\n        color: '#999',\r\n        marginTop: '8px',\r\n        fontWeight: 'bold'\r\n      }}>\r\n        FILE\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // Render based on media type\r\n  if (!imageError && (currentMediaType === 'image' || currentMediaType === 'unknown')) {\r\n    return renderImageThumbnail();\r\n  } else if (currentMediaType === 'video') {\r\n    return renderVideoThumbnail();\r\n  } else if (currentMediaType === 'audio') {\r\n    return renderAudioThumbnail();\r\n  } else {\r\n    return renderUnknownThumbnail();\r\n  }\r\n};\r\n\r\nconst Gallery = () => {\r\n  const [mediaItems, setMediaItems] = useState([]);\r\n  const [searchTag, setSearchTag] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n\r\n  const apiBase = 'https://5myucif3s8.execute-api.us-east-1.amazonaws.com/dev';\r\n\r\n  useEffect(() => {\r\n    const fetchMedia = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const { tokens } = await fetchAuthSession();\r\n        const idToken = tokens?.idToken?.toString();\r\n\r\n        if (!idToken) {\r\n          throw new Error('Authentication token not available');\r\n        }\r\n\r\n        const res = await fetch(`${apiBase}/show-gallery`, {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${idToken}`,\r\n          },\r\n        });\r\n\r\n        if (!res.ok) {\r\n          const text = await res.text();\r\n          throw new Error(`Fetch failed: ${res.status} ${text}`);\r\n        }\r\n\r\n        const data = await res.json();\r\n        console.log('Gallery API response:', data);\r\n\r\n        // Transform the grouped gallery data into flat array\r\n        const allItems = transformGalleryData(data.gallery || {});\r\n        setMediaItems(allItems);\r\n        setTotalCount(data.total_count || allItems.length);\r\n        setError('');\r\n      } catch (err) {\r\n        console.error('Error fetching media:', err);\r\n        setError('Failed to load media files.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchMedia();\r\n  }, []);\r\n\r\n  // Transform the grouped gallery response into format for display\r\n  const transformGalleryData = (gallery) => {\r\n    const allItems = [];\r\n    \r\n    // Process all file types\r\n    ['images', 'audio', 'video', 'other'].forEach(fileType => {\r\n      if (gallery[fileType] && Array.isArray(gallery[fileType])) {\r\n        gallery[fileType].forEach(item => {\r\n          // Transform tags from object format {crow: 2, pigeon: 1} to array format [\"crow (2)\", \"pigeon (1)\"]\r\n          const tagsArray = transformTags(item.tags || {});\r\n          \r\n          allItems.push({\r\n            url: item.url,\r\n            file_type: item.file_type,\r\n            file_id: item.file_id,\r\n            upload_date: item.upload_date,\r\n            tags: tagsArray,\r\n            tagsObject: item.tags || {} // Keep original for filtering\r\n          });\r\n        });\r\n      }\r\n    });\r\n    \r\n    return allItems;\r\n  };\r\n\r\n  // Convert tags object to array format for display\r\n  const transformTags = (tagsObject) => {\r\n    if (!tagsObject || typeof tagsObject !== 'object') {\r\n      return [];\r\n    }\r\n    \r\n    return Object.entries(tagsObject).map(([species, count]) => {\r\n      return count > 1 ? `${species} (${count})` : species;\r\n    });\r\n  };\r\n\r\n  // Enhanced media click handler (copied from Search.js)\r\n  const handleMediaClick = async (mediaUrl) => {\r\n    try {\r\n      setLoading(true);\r\n      setError('');\r\n      \r\n      console.log('Opening media:', mediaUrl);\r\n\r\n      // For images that are thumbnails, try to get original\r\n      if (mediaUrl.includes('/thumbnails/')) {\r\n        try {\r\n          const { tokens } = await fetchAuthSession();\r\n          const token = tokens?.idToken?.toString();\r\n\r\n          const response = await fetch(\r\n            `${apiBase}/search/by-thumbnail-url?thumbnail_url=${encodeURIComponent(mediaUrl)}`,\r\n            {\r\n              method: 'GET',\r\n              headers: {\r\n                'Authorization': `Bearer ${token}`,\r\n                'Content-Type': 'application/json'\r\n              }\r\n            }\r\n          );\r\n\r\n          if (response.ok) {\r\n            const data = await response.json();\r\n            if (data.links && data.links.length > 0) {\r\n              window.open(data.links[0], '_blank');\r\n              return;\r\n            }\r\n          }\r\n        } catch (err) {\r\n          console.error('API lookup failed, trying fallback:', err);\r\n        }\r\n        \r\n        // Fallback: construct original URL\r\n        const originalUrl = mediaUrl.replace('/thumbnails/', '/');\r\n        window.open(originalUrl, '_blank');\r\n      } else {\r\n        // It's already the original URL\r\n        window.open(mediaUrl, '_blank');\r\n      }\r\n    } catch (err) {\r\n      console.error('Media click failed:', err);\r\n      setError(`Error opening media: ${err.message}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Filter items based on search tag\r\n  const filteredItems = searchTag\r\n    ? mediaItems.filter((item) => {\r\n        // Search in both the display tags and original tags object\r\n        const searchLower = searchTag.toLowerCase();\r\n        \r\n        // Check display tags\r\n        const matchesDisplayTags = item.tags?.some(tag =>\r\n          tag.toLowerCase().includes(searchLower)\r\n        );\r\n        \r\n        // Check original tags object keys\r\n        const matchesOriginalTags = Object.keys(item.tagsObject || {}).some(species =>\r\n          species.toLowerCase().includes(searchLower)\r\n        );\r\n        \r\n        return matchesDisplayTags || matchesOriginalTags;\r\n      })\r\n    : mediaItems;\r\n\r\n  return (\r\n    <div style={{ padding: '20px' }}>\r\n      <h2>Gallery</h2>\r\n\r\n      {/* Search input */}\r\n      <div style={{ marginBottom: '20px' }}>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Filter by bird species...\"\r\n          value={searchTag}\r\n          onChange={(e) => setSearchTag(e.target.value)}\r\n          className=\"search-input\"\r\n          style={{\r\n            padding: '12px',\r\n            width: '300px',\r\n            border: '2px solid #ddd',\r\n            borderRadius: '6px',\r\n            fontSize: '14px'\r\n          }}\r\n        />\r\n      </div>\r\n\r\n      {/* Loading state */}\r\n      {loading && (\r\n        <div style={{\r\n          color: '#1976d2',\r\n          backgroundColor: '#e3f2fd',\r\n          padding: '10px',\r\n          borderRadius: '4px',\r\n          marginBottom: '20px'\r\n        }}>\r\n          Loading gallery...\r\n        </div>\r\n      )}\r\n\r\n      {/* Error state */}\r\n      {error && (\r\n        <div style={{\r\n          color: '#d32f2f',\r\n          backgroundColor: '#ffebee',\r\n          padding: '12px',\r\n          borderRadius: '4px',\r\n          marginBottom: '20px',\r\n          borderLeft: '4px solid #d32f2f'\r\n        }}>\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {/* Gallery grid */}\r\n      <div className=\"gallery-grid\">\r\n        {filteredItems.length === 0 && !loading ? (\r\n          <p>No matching files found.</p>\r\n        ) : (\r\n          filteredItems.map((item, index) => (\r\n            <div key={item.file_id || index} className=\"gallery-tile\">\r\n              {/* Media thumbnail */}\r\n              <MediaThumbnail\r\n                url={item.url}\r\n                fileType={item.file_type}\r\n                tags={item.tags}\r\n                onMediaClick={handleMediaClick}\r\n              />\r\n              \r\n              {/* Tags display */}\r\n              {item.tags && item.tags.length > 0 && (\r\n                <ul>\r\n                  {item.tags.map((tag, i) => (\r\n                    <li key={i}>{tag}</li>\r\n                  ))}\r\n                </ul>\r\n              )}\r\n              \r\n              {/* Upload date */}\r\n              {item.upload_date && (\r\n                <div className=\"upload-date\">\r\n                  {new Date(item.upload_date).toLocaleDateString()}\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))\r\n        )}\r\n      </div>\r\n      \r\n      {/* File count */}\r\n      {mediaItems.length > 0 && (\r\n        <div className=\"file-count\">\r\n          Showing {filteredItems.length} of {totalCount} files\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Gallery;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}