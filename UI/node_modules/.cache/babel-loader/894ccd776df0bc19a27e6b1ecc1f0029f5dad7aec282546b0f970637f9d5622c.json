{"ast":null,"code":"import _objectSpread from \"/Users/saisaran/Desktop/BirdTag/UI/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { Amplify } from '@aws-amplify/core';\nimport { StorageAction } from '@aws-amplify/core/internals/utils';\nimport { resolveS3ConfigAndInput } from '../../utils/resolveS3ConfigAndInput.mjs';\nimport '@smithy/md5-js';\nimport '@aws-amplify/core/internals/aws-client-utils';\nimport '../../utils/client/runtime/s3TransferHandler/fetch.mjs';\nimport 'fast-xml-parser';\nimport '../../utils/client/runtime/s3TransferHandler/xhr.mjs';\nimport 'buffer';\nimport { createDownloadTask } from '../../utils/transferTask.mjs';\nimport { validateBucketOwnerID } from '../../utils/validateBucketOwnerID.mjs';\nimport { validateStorageOperationInput } from '../../utils/validateStorageOperationInput.mjs';\nimport '../../../../errors/types/validation.mjs';\nimport { STORAGE_INPUT_KEY } from '../../utils/constants.mjs';\nimport '../../utils/client/s3data/base.mjs';\nimport { getObject } from '../../utils/client/s3data/getObject.mjs';\nimport '../../utils/client/s3data/listObjectsV2.mjs';\nimport '../../utils/client/s3data/putObject.mjs';\nimport '../../utils/client/s3data/createMultipartUpload.mjs';\nimport '../../utils/client/s3data/uploadPart.mjs';\nimport '../../utils/client/s3data/completeMultipartUpload.mjs';\nimport '../../utils/client/s3data/listParts.mjs';\nimport '../../utils/client/s3data/abortMultipartUpload.mjs';\nimport '../../utils/client/s3data/copyObject.mjs';\nimport '../../utils/client/s3data/headObject.mjs';\nimport '../../utils/client/s3data/deleteObject.mjs';\nimport { getStorageUserAgentValue } from '../../utils/userAgent.mjs';\nimport { logger } from '../../../../utils/logger.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst downloadData = input => {\n  const abortController = new AbortController();\n  const downloadTask = createDownloadTask({\n    job: downloadDataJob(input, abortController.signal),\n    onCancel: message => {\n      abortController.abort(message);\n    }\n  });\n  return downloadTask;\n};\nconst downloadDataJob = (downloadDataInput, abortSignal) => async () => {\n  const {\n    options: downloadDataOptions\n  } = downloadDataInput;\n  const {\n    bucket,\n    keyPrefix,\n    s3Config,\n    identityId\n  } = await resolveS3ConfigAndInput(Amplify, downloadDataInput);\n  const {\n    inputType,\n    objectKey\n  } = validateStorageOperationInput(downloadDataInput, identityId);\n  validateBucketOwnerID(downloadDataOptions === null || downloadDataOptions === void 0 ? void 0 : downloadDataOptions.expectedBucketOwner);\n  const finalKey = inputType === STORAGE_INPUT_KEY ? keyPrefix + objectKey : objectKey;\n  logger.debug(\"download \".concat(objectKey, \" from \").concat(finalKey, \".\"));\n  const {\n    Body: body,\n    LastModified: lastModified,\n    ContentLength: size,\n    ETag: eTag,\n    Metadata: metadata,\n    VersionId: versionId,\n    ContentType: contentType\n  } = await getObject(_objectSpread(_objectSpread({}, s3Config), {}, {\n    abortSignal,\n    onDownloadProgress: downloadDataOptions === null || downloadDataOptions === void 0 ? void 0 : downloadDataOptions.onProgress,\n    userAgentValue: getStorageUserAgentValue(StorageAction.DownloadData)\n  }), _objectSpread(_objectSpread({\n    Bucket: bucket,\n    Key: finalKey\n  }, (downloadDataOptions === null || downloadDataOptions === void 0 ? void 0 : downloadDataOptions.bytesRange) && {\n    Range: \"bytes=\".concat(downloadDataOptions.bytesRange.start, \"-\").concat(downloadDataOptions.bytesRange.end)\n  }), {}, {\n    ExpectedBucketOwner: downloadDataOptions === null || downloadDataOptions === void 0 ? void 0 : downloadDataOptions.expectedBucketOwner\n  }));\n  const result = {\n    body,\n    lastModified,\n    size,\n    contentType,\n    eTag,\n    metadata,\n    versionId\n  };\n  return inputType === STORAGE_INPUT_KEY ? _objectSpread({\n    key: objectKey\n  }, result) : _objectSpread({\n    path: objectKey\n  }, result);\n};\nexport { downloadData };","map":{"version":3,"names":["downloadData","input","abortController","AbortController","downloadTask","createDownloadTask","job","downloadDataJob","signal","onCancel","message","abort","downloadDataInput","abortSignal","options","downloadDataOptions","bucket","keyPrefix","s3Config","identityId","resolveS3ConfigAndInput","Amplify","inputType","objectKey","validateStorageOperationInput","validateBucketOwnerID","expectedBucketOwner","finalKey","STORAGE_INPUT_KEY","logger","debug","concat","Body","body","LastModified","lastModified","ContentLength","size","ETag","eTag","Metadata","metadata","VersionId","versionId","ContentType","contentType","getObject","_objectSpread","onDownloadProgress","onProgress","userAgentValue","getStorageUserAgentValue","StorageAction","DownloadData","Bucket","Key","bytesRange","Range","start","end","ExpectedBucketOwner","result","key","path"],"sources":["/Users/saisaran/Desktop/BirdTag/UI/node_modules/@aws-amplify/storage/src/providers/s3/apis/internal/downloadData.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { Amplify } from '@aws-amplify/core';\nimport { StorageAction } from '@aws-amplify/core/internals/utils';\nimport { resolveS3ConfigAndInput } from '../../utils/resolveS3ConfigAndInput';\nimport { createDownloadTask, validateBucketOwnerID, validateStorageOperationInput, } from '../../utils';\nimport { getObject } from '../../utils/client/s3data';\nimport { getStorageUserAgentValue } from '../../utils/userAgent';\nimport { logger } from '../../../../utils';\nimport { STORAGE_INPUT_KEY } from '../../utils/constants';\nexport const downloadData = (input) => {\n    const abortController = new AbortController();\n    const downloadTask = createDownloadTask({\n        job: downloadDataJob(input, abortController.signal),\n        onCancel: (message) => {\n            abortController.abort(message);\n        },\n    });\n    return downloadTask;\n};\nconst downloadDataJob = (downloadDataInput, abortSignal) => async () => {\n    const { options: downloadDataOptions } = downloadDataInput;\n    const { bucket, keyPrefix, s3Config, identityId } = await resolveS3ConfigAndInput(Amplify, downloadDataInput);\n    const { inputType, objectKey } = validateStorageOperationInput(downloadDataInput, identityId);\n    validateBucketOwnerID(downloadDataOptions?.expectedBucketOwner);\n    const finalKey = inputType === STORAGE_INPUT_KEY ? keyPrefix + objectKey : objectKey;\n    logger.debug(`download ${objectKey} from ${finalKey}.`);\n    const { Body: body, LastModified: lastModified, ContentLength: size, ETag: eTag, Metadata: metadata, VersionId: versionId, ContentType: contentType, } = await getObject({\n        ...s3Config,\n        abortSignal,\n        onDownloadProgress: downloadDataOptions?.onProgress,\n        userAgentValue: getStorageUserAgentValue(StorageAction.DownloadData),\n    }, {\n        Bucket: bucket,\n        Key: finalKey,\n        ...(downloadDataOptions?.bytesRange && {\n            Range: `bytes=${downloadDataOptions.bytesRange.start}-${downloadDataOptions.bytesRange.end}`,\n        }),\n        ExpectedBucketOwner: downloadDataOptions?.expectedBucketOwner,\n    });\n    const result = {\n        body,\n        lastModified,\n        size,\n        contentType,\n        eTag,\n        metadata,\n        versionId,\n    };\n    return inputType === STORAGE_INPUT_KEY\n        ? { key: objectKey, ...result }\n        : { path: objectKey, ...result };\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AASY,MAACA,YAAY,GAAIC,KAAK,IAAK;EACnC,MAAMC,eAAe,GAAG,IAAIC,eAAe,EAAE;EAC7C,MAAMC,YAAY,GAAGC,kBAAkB,CAAC;IACpCC,GAAG,EAAEC,eAAe,CAACN,KAAK,EAAEC,eAAe,CAACM,MAAM,CAAC;IACnDC,QAAQ,EAAGC,OAAO,IAAK;MACnBR,eAAe,CAACS,KAAK,CAACD,OAAO,CAAC;IAC1C;EACA,CAAK,CAAC;EACF,OAAON,YAAY;AACvB;AACA,MAAMG,eAAe,GAAGA,CAACK,iBAAiB,EAAEC,WAAW,KAAK,YAAY;EACpE,MAAM;IAAEC,OAAO,EAAEC;EAAmB,CAAE,GAAGH,iBAAiB;EAC1D,MAAM;IAAEI,MAAM;IAAEC,SAAS;IAAEC,QAAQ;IAAEC;EAAU,CAAE,GAAG,MAAMC,uBAAuB,CAACC,OAAO,EAAET,iBAAiB,CAAC;EAC7G,MAAM;IAAEU,SAAS;IAAEC;EAAS,CAAE,GAAGC,6BAA6B,CAACZ,iBAAiB,EAAEO,UAAU,CAAC;EAC7FM,qBAAqB,CAACV,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAEW,mBAAmB,CAAC;EAC/D,MAAMC,QAAQ,GAAGL,SAAS,KAAKM,iBAAiB,GAAGX,SAAS,GAAGM,SAAS,GAAGA,SAAS;EACpFM,MAAM,CAACC,KAAK,aAAAC,MAAA,CAAaR,SAAS,YAAAQ,MAAA,CAASJ,QAAQ,MAAG,CAAC;EACvD,MAAM;IAAEK,IAAI,EAAEC,IAAI;IAAEC,YAAY,EAAEC,YAAY;IAAEC,aAAa,EAAEC,IAAI;IAAEC,IAAI,EAAEC,IAAI;IAAEC,QAAQ,EAAEC,QAAQ;IAAEC,SAAS,EAAEC,SAAS;IAAEC,WAAW,EAAEC;EAAW,CAAG,GAAG,MAAMC,SAAS,CAAAC,aAAA,CAAAA,aAAA,KACjK7B,QAAQ;IACXL,WAAW;IACXmC,kBAAkB,EAAEjC,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAEkC,UAAU;IACnDC,cAAc,EAAEC,wBAAwB,CAACC,aAAa,CAACC,YAAY;EAAC,IAAAN,aAAA,CAAAA,aAAA;IAEpEO,MAAM,EAAEtC,MAAM;IACduC,GAAG,EAAE5B;EAAQ,GACT,CAAAZ,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAEyC,UAAU,KAAI;IACnCC,KAAK,WAAA1B,MAAA,CAAWhB,mBAAmB,CAACyC,UAAU,CAACE,KAAK,OAAA3B,MAAA,CAAIhB,mBAAmB,CAACyC,UAAU,CAACG,GAAG;EACtG,CAAS;IACDC,mBAAmB,EAAE7C,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAEW;EAAmB,EAChE,CAAC;EACF,MAAMmC,MAAM,GAAG;IACX5B,IAAI;IACJE,YAAY;IACZE,IAAI;IACJQ,WAAW;IACXN,IAAI;IACJE,QAAQ;IACRE;EACR,CAAK;EACD,OAAOrB,SAAS,KAAKM,iBAAA,GAAAmB,aAAA;IACbe,GAAG,EAAEvC;EAAS,GAAKsC,MAAM,IAAAd,aAAA;IACzBgB,IAAI,EAAExC;EAAS,GAAKsC,MAAM,CAAE;AACxC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}