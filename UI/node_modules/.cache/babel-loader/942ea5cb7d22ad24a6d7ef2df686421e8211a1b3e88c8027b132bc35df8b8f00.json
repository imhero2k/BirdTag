{"ast":null,"code":"import { StorageError } from '../../../../../errors/StorageError.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n/**\n * Maps an object to a new object using the provided instructions.\n * The instructions are a map of the returning mapped object's property names to a single instruction of how to map the\n * value from the original object to the new object. There are two types of instructions:\n *\n * 1. A string representing the property name of the original object to map to the new object. The value mapped from\n * the original object will be the same as the value in the new object, and it can ONLY be string.\n *\n * 2. An array of two elements. The first element is the property name of the original object to map to the new object.\n * The second element is a function that takes the value from the original object and returns the value to be mapped to\n * the new object. The function can return any type.\n *\n * Example:\n * ```typescript\n * const input = {\n *   Foo: 'foo',\n *   BarList: [{value: 'bar1'}, {value: 'bar2'}]\n * }\n * const output = map(input, {\n *   someFoo: 'Foo',\n *   bar: ['BarList', (barList) => barList.map(bar => bar.value)]\n *   baz: 'Baz' // Baz does not exist in input, so it will not be in the output.\n * });\n * // output = { someFoo: 'foo', bar: ['bar1', 'bar2'] }\n * ```\n *\n * @param obj The object containing the data to compose mapped object.\n * @param instructions The instructions mapping the object values to the new object.\n * @returns A new object with the mapped values.\n *\n * @internal\n */\nconst map = (obj, instructions) => {\n  const result = {};\n  for (const [key, instruction] of Object.entries(instructions)) {\n    const [accessor, deserializer] = Array.isArray(instruction) ? instruction : [instruction];\n    if (Object.prototype.hasOwnProperty.call(obj, accessor)) {\n      result[key] = deserializer ? deserializer(obj[accessor]) : String(obj[accessor]);\n    }\n  }\n  return result;\n};\n/**\n * Deserializes a string to a number. Returns undefined if input is undefined.\n *\n * @internal\n */\nconst deserializeNumber = value => value ? Number(value) : undefined;\n/**\n * Deserializes a string to a boolean. Returns undefined if input is undefined. Returns true if input is 'true',\n * otherwise false.\n *\n * @internal\n */\nconst deserializeBoolean = value => {\n  return value ? value === 'true' : undefined;\n};\n/**\n * Deserializes a string to a Date. Returns undefined if input is undefined.\n * It supports epoch timestamp; rfc3339(cannot have a UTC, fractional precision supported); rfc7231(section 7.1.1.1)\n *\n * @see https://www.epoch101.com/\n * @see https://datatracker.ietf.org/doc/html/rfc3339.html#section-5.6\n * @see https://datatracker.ietf.org/doc/html/rfc7231.html#section-7.1.1.1\n *\n * @note For bundle size consideration, we use Date constructor to parse the timestamp string. There might be slight\n * difference among browsers.\n *\n * @internal\n */\nconst deserializeTimestamp = value => {\n  return value ? new Date(value) : undefined;\n};\n/**\n * Create a function deserializing a string to an enum value. If the string is not a valid enum value, it throws a\n * StorageError.\n *\n * This utility is ONLY preferred if the enum value is critical. Since the enum values are hard-coded, new enum values\n * returned from service would break the library.\n *\n * @example\n * ```typescript\n * const deserializeStringEnum = createStringEnumDeserializer(['a', 'b', 'c'] as const, 'FieldName');\n * const deserializedArray = ['a', 'b', 'c'].map(deserializeStringEnum);\n * // deserializedArray = ['a', 'b', 'c']\n *\n * const invalidValue = deserializeStringEnum('d');\n * // Throws InvalidFieldName: Invalid FieldName: d\n * ```\n *\n * @internal\n */\nconst createStringEnumDeserializer = (enumValues, fieldName) => {\n  const deserializeStringEnum = value => {\n    const parsedEnumValue = value ? enumValues.find(enumValue => enumValue === value) : undefined;\n    if (!parsedEnumValue) {\n      throw new StorageError({\n        name: \"Invalid\".concat(fieldName),\n        message: \"Invalid \".concat(fieldName, \": \").concat(value),\n        recoverySuggestion: 'This is likely to be a bug. Please reach out to library authors.'\n      });\n    }\n    return parsedEnumValue;\n  };\n  return deserializeStringEnum;\n};\n/**\n * Deserializes a string to a string tag type. The function simply casts the parsed string into a given string tag type.\n * It does NOT validate the string value against the string tag. This behavior is the same to AWS SDK parsing logic of\n * string tag types.\n *\n * If you need to verify the string value, you must use {@link createStringEnumDeserializer} instead.\n *\n * @internal\n */\nconst deserializeStringTag = value => String(value);\n/**\n * Function that makes sure the deserializer receives non-empty array.\n *\n * @internal\n */\nconst emptyArrayGuard = (value, deserializer) => {\n  if (value === '') {\n    return [];\n  }\n  const valueArray = (Array.isArray(value) ? value : [value]).filter(e => e != null);\n  return deserializer(valueArray);\n};\n/**\n * @internal\n */\nconst deserializeMetadata = headers => {\n  const objectMetadataHeaderPrefix = 'x-amz-meta-';\n  const deserialized = Object.keys(headers).filter(header => header.startsWith(objectMetadataHeaderPrefix)).reduce((acc, header) => {\n    acc[header.replace(objectMetadataHeaderPrefix, '')] = headers[header];\n    return acc;\n  }, {});\n  return Object.keys(deserialized).length > 0 ? deserialized : undefined;\n};\n/**\n * Internal-only method to create a new StorageError from a service error with AWS SDK-compatible interfaces\n * @param error - The output of a service error parser, with AWS SDK-compatible interface(e.g. $metadata)\n * @returns A new StorageError.\n *\n * @internal\n */\nconst buildStorageServiceError = error => new StorageError({\n  name: error.name,\n  message: error.message,\n  metadata: error.$metadata\n});\n/**\n * Internal-only method used for deserializing the parts of a multipart upload.\n *\n * @internal\n */\nconst deserializeCompletedPartList = input => input.map(item => map(item, {\n  PartNumber: ['PartNumber', deserializeNumber],\n  ETag: 'ETag',\n  ChecksumCRC32: 'ChecksumCRC32'\n}));\nexport { buildStorageServiceError, createStringEnumDeserializer, deserializeBoolean, deserializeCompletedPartList, deserializeMetadata, deserializeNumber, deserializeStringTag, deserializeTimestamp, emptyArrayGuard, map };","map":{"version":3,"names":["map","obj","instructions","result","key","instruction","Object","entries","accessor","deserializer","Array","isArray","prototype","hasOwnProperty","call","String","deserializeNumber","value","Number","undefined","deserializeBoolean","deserializeTimestamp","Date","createStringEnumDeserializer","enumValues","fieldName","deserializeStringEnum","parsedEnumValue","find","enumValue","StorageError","name","concat","message","recoverySuggestion","deserializeStringTag","emptyArrayGuard","valueArray","filter","e","deserializeMetadata","headers","objectMetadataHeaderPrefix","deserialized","keys","header","startsWith","reduce","acc","replace","length","buildStorageServiceError","error","metadata","$metadata","deserializeCompletedPartList","input","item","PartNumber","ETag","ChecksumCRC32"],"sources":["/Users/saisaran/Desktop/BirdTag/UI/node_modules/@aws-amplify/storage/src/providers/s3/utils/client/utils/deserializeHelpers.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { StorageError } from '../../../../../errors/StorageError';\n/**\n * Maps an object to a new object using the provided instructions.\n * The instructions are a map of the returning mapped object's property names to a single instruction of how to map the\n * value from the original object to the new object. There are two types of instructions:\n *\n * 1. A string representing the property name of the original object to map to the new object. The value mapped from\n * the original object will be the same as the value in the new object, and it can ONLY be string.\n *\n * 2. An array of two elements. The first element is the property name of the original object to map to the new object.\n * The second element is a function that takes the value from the original object and returns the value to be mapped to\n * the new object. The function can return any type.\n *\n * Example:\n * ```typescript\n * const input = {\n *   Foo: 'foo',\n *   BarList: [{value: 'bar1'}, {value: 'bar2'}]\n * }\n * const output = map(input, {\n *   someFoo: 'Foo',\n *   bar: ['BarList', (barList) => barList.map(bar => bar.value)]\n *   baz: 'Baz' // Baz does not exist in input, so it will not be in the output.\n * });\n * // output = { someFoo: 'foo', bar: ['bar1', 'bar2'] }\n * ```\n *\n * @param obj The object containing the data to compose mapped object.\n * @param instructions The instructions mapping the object values to the new object.\n * @returns A new object with the mapped values.\n *\n * @internal\n */\nexport const map = (obj, instructions) => {\n    const result = {};\n    for (const [key, instruction] of Object.entries(instructions)) {\n        const [accessor, deserializer] = Array.isArray(instruction)\n            ? instruction\n            : [instruction];\n        if (Object.prototype.hasOwnProperty.call(obj, accessor)) {\n            result[key] = deserializer\n                ? deserializer(obj[accessor])\n                : String(obj[accessor]);\n        }\n    }\n    return result;\n};\n/**\n * Deserializes a string to a number. Returns undefined if input is undefined.\n *\n * @internal\n */\nexport const deserializeNumber = (value) => value ? Number(value) : undefined;\n/**\n * Deserializes a string to a boolean. Returns undefined if input is undefined. Returns true if input is 'true',\n * otherwise false.\n *\n * @internal\n */\nexport const deserializeBoolean = (value) => {\n    return value ? value === 'true' : undefined;\n};\n/**\n * Deserializes a string to a Date. Returns undefined if input is undefined.\n * It supports epoch timestamp; rfc3339(cannot have a UTC, fractional precision supported); rfc7231(section 7.1.1.1)\n *\n * @see https://www.epoch101.com/\n * @see https://datatracker.ietf.org/doc/html/rfc3339.html#section-5.6\n * @see https://datatracker.ietf.org/doc/html/rfc7231.html#section-7.1.1.1\n *\n * @note For bundle size consideration, we use Date constructor to parse the timestamp string. There might be slight\n * difference among browsers.\n *\n * @internal\n */\nexport const deserializeTimestamp = (value) => {\n    return value ? new Date(value) : undefined;\n};\n/**\n * Create a function deserializing a string to an enum value. If the string is not a valid enum value, it throws a\n * StorageError.\n *\n * This utility is ONLY preferred if the enum value is critical. Since the enum values are hard-coded, new enum values\n * returned from service would break the library.\n *\n * @example\n * ```typescript\n * const deserializeStringEnum = createStringEnumDeserializer(['a', 'b', 'c'] as const, 'FieldName');\n * const deserializedArray = ['a', 'b', 'c'].map(deserializeStringEnum);\n * // deserializedArray = ['a', 'b', 'c']\n *\n * const invalidValue = deserializeStringEnum('d');\n * // Throws InvalidFieldName: Invalid FieldName: d\n * ```\n *\n * @internal\n */\nexport const createStringEnumDeserializer = (enumValues, fieldName) => {\n    const deserializeStringEnum = (value) => {\n        const parsedEnumValue = value\n            ? enumValues.find(enumValue => enumValue === value)\n            : undefined;\n        if (!parsedEnumValue) {\n            throw new StorageError({\n                name: `Invalid${fieldName}`,\n                message: `Invalid ${fieldName}: ${value}`,\n                recoverySuggestion: 'This is likely to be a bug. Please reach out to library authors.',\n            });\n        }\n        return parsedEnumValue;\n    };\n    return deserializeStringEnum;\n};\n/**\n * Deserializes a string to a string tag type. The function simply casts the parsed string into a given string tag type.\n * It does NOT validate the string value against the string tag. This behavior is the same to AWS SDK parsing logic of\n * string tag types.\n *\n * If you need to verify the string value, you must use {@link createStringEnumDeserializer} instead.\n *\n * @internal\n */\nexport const deserializeStringTag = (value) => String(value);\n/**\n * Function that makes sure the deserializer receives non-empty array.\n *\n * @internal\n */\nexport const emptyArrayGuard = (value, deserializer) => {\n    if (value === '') {\n        return [];\n    }\n    const valueArray = (Array.isArray(value) ? value : [value]).filter(e => e != null);\n    return deserializer(valueArray);\n};\n/**\n * @internal\n */\nexport const deserializeMetadata = (headers) => {\n    const objectMetadataHeaderPrefix = 'x-amz-meta-';\n    const deserialized = Object.keys(headers)\n        .filter(header => header.startsWith(objectMetadataHeaderPrefix))\n        .reduce((acc, header) => {\n        acc[header.replace(objectMetadataHeaderPrefix, '')] = headers[header];\n        return acc;\n    }, {});\n    return Object.keys(deserialized).length > 0 ? deserialized : undefined;\n};\n/**\n * Internal-only method to create a new StorageError from a service error with AWS SDK-compatible interfaces\n * @param error - The output of a service error parser, with AWS SDK-compatible interface(e.g. $metadata)\n * @returns A new StorageError.\n *\n * @internal\n */\nexport const buildStorageServiceError = (error) => new StorageError({\n    name: error.name,\n    message: error.message,\n    metadata: error.$metadata,\n});\n/**\n * Internal-only method used for deserializing the parts of a multipart upload.\n *\n * @internal\n */\nexport const deserializeCompletedPartList = (input) => input.map(item => map(item, {\n    PartNumber: ['PartNumber', deserializeNumber],\n    ETag: 'ETag',\n    ChecksumCRC32: 'ChecksumCRC32',\n}));\n"],"mappings":";;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACY,MAACA,GAAG,GAAGA,CAACC,GAAG,EAAEC,YAAY,KAAK;EACtC,MAAMC,MAAM,GAAG,EAAE;EACjB,KAAK,MAAM,CAACC,GAAG,EAAEC,WAAW,CAAC,IAAIC,MAAM,CAACC,OAAO,CAACL,YAAY,CAAC,EAAE;IAC3D,MAAM,CAACM,QAAQ,EAAEC,YAAY,CAAC,GAAGC,KAAK,CAACC,OAAO,CAACN,WAAW,IACpDA,WAAA,GACA,CAACA,WAAW,CAAC;IACnB,IAAIC,MAAM,CAACM,SAAS,CAACC,cAAc,CAACC,IAAI,CAACb,GAAG,EAAEO,QAAQ,CAAC,EAAE;MACrDL,MAAM,CAACC,GAAG,CAAC,GAAGK,YAAA,GACRA,YAAY,CAACR,GAAG,CAACO,QAAQ,CAAC,IAC1BO,MAAM,CAACd,GAAG,CAACO,QAAQ,CAAC,CAAC;IACvC;EACA;EACI,OAAOL,MAAM;AACjB;AACA;AACA;AACA;AACA;AACA;AACY,MAACa,iBAAiB,GAAIC,KAAK,IAAKA,KAAK,GAAGC,MAAM,CAACD,KAAK,CAAC,GAAGE,SAAA;AACpE;AACA;AACA;AACA;AACA;AACA;AACY,MAACC,kBAAkB,GAAIH,KAAK,IAAK;EACzC,OAAOA,KAAK,GAAGA,KAAK,KAAK,MAAM,GAAGE,SAAS;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACY,MAACE,oBAAoB,GAAIJ,KAAK,IAAK;EAC3C,OAAOA,KAAK,GAAG,IAAIK,IAAI,CAACL,KAAK,CAAC,GAAGE,SAAS;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACY,MAACI,4BAA4B,GAAGA,CAACC,UAAU,EAAEC,SAAS,KAAK;EACnE,MAAMC,qBAAqB,GAAIT,KAAK,IAAK;IACrC,MAAMU,eAAe,GAAGV,KAAA,GAClBO,UAAU,CAACI,IAAI,CAACC,SAAS,IAAIA,SAAS,KAAKZ,KAAK,IAChDE,SAAS;IACf,IAAI,CAACQ,eAAe,EAAE;MAClB,MAAM,IAAIG,YAAY,CAAC;QACnBC,IAAI,YAAAC,MAAA,CAAYP,SAAS,CAAE;QAC3BQ,OAAO,aAAAD,MAAA,CAAaP,SAAS,QAAAO,MAAA,CAAKf,KAAK,CAAE;QACzCiB,kBAAkB,EAAE;MACpC,CAAa,CAAC;IACd;IACQ,OAAOP,eAAe;EAC9B,CAAK;EACD,OAAOD,qBAAqB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACY,MAACS,oBAAoB,GAAIlB,KAAK,IAAKF,MAAM,CAACE,KAAK;AAC3D;AACA;AACA;AACA;AACA;AACY,MAACmB,eAAe,GAAGA,CAACnB,KAAK,EAAER,YAAY,KAAK;EACpD,IAAIQ,KAAK,KAAK,EAAE,EAAE;IACd,OAAO,EAAE;EACjB;EACI,MAAMoB,UAAU,GAAG,CAAC3B,KAAK,CAACC,OAAO,CAACM,KAAK,CAAC,GAAGA,KAAK,GAAG,CAACA,KAAK,CAAC,EAAEqB,MAAM,CAACC,CAAC,IAAIA,CAAC,IAAI,IAAI,CAAC;EAClF,OAAO9B,YAAY,CAAC4B,UAAU,CAAC;AACnC;AACA;AACA;AACA;AACY,MAACG,mBAAmB,GAAIC,OAAO,IAAK;EAC5C,MAAMC,0BAA0B,GAAG,aAAa;EAChD,MAAMC,YAAY,GAAGrC,MAAM,CAACsC,IAAI,CAACH,OAAO,EACnCH,MAAM,CAACO,MAAM,IAAIA,MAAM,CAACC,UAAU,CAACJ,0BAA0B,CAAC,EAC9DK,MAAM,CAAC,CAACC,GAAG,EAAEH,MAAM,KAAK;IACzBG,GAAG,CAACH,MAAM,CAACI,OAAO,CAACP,0BAA0B,EAAE,EAAE,CAAC,CAAC,GAAGD,OAAO,CAACI,MAAM,CAAC;IACrE,OAAOG,GAAG;EAClB,CAAK,EAAE,EAAE,CAAC;EACN,OAAO1C,MAAM,CAACsC,IAAI,CAACD,YAAY,CAAC,CAACO,MAAM,GAAG,CAAC,GAAGP,YAAY,GAAGxB,SAAS;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACY,MAACgC,wBAAwB,GAAIC,KAAK,IAAK,IAAItB,YAAY,CAAC;EAChEC,IAAI,EAAEqB,KAAK,CAACrB,IAAI;EAChBE,OAAO,EAAEmB,KAAK,CAACnB,OAAO;EACtBoB,QAAQ,EAAED,KAAK,CAACE;AACpB,CAAC;AACD;AACA;AACA;AACA;AACA;AACY,MAACC,4BAA4B,GAAIC,KAAK,IAAKA,KAAK,CAACxD,GAAG,CAACyD,IAAI,IAAIzD,GAAG,CAACyD,IAAI,EAAE;EAC/EC,UAAU,EAAE,CAAC,YAAY,EAAE1C,iBAAiB,CAAC;EAC7C2C,IAAI,EAAE,MAAM;EACZC,aAAa,EAAE;AACnB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}