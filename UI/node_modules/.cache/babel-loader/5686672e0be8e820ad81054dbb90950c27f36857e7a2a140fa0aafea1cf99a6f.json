{"ast":null,"code":"import _objectSpread from \"/Users/saisaran/Desktop/BirdTag/UI/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { parseMetadata } from '@aws-amplify/core/internals/aws-client-utils';\nimport { AmplifyUrl, AmplifyUrlSearchParams } from '@aws-amplify/core/internals/utils';\nimport { composeServiceApi } from '@aws-amplify/core/internals/aws-client-utils/composers';\nimport { parseXmlBody } from '../utils/parsePayload.mjs';\nimport { s3TransferHandler } from '../runtime/s3TransferHandler/fetch.mjs';\nimport 'fast-xml-parser';\nimport '../runtime/s3TransferHandler/xhr.mjs';\nimport 'buffer';\nimport { buildStorageServiceError, map, deserializeNumber, deserializeBoolean, deserializeStringTag, emptyArrayGuard, deserializeTimestamp } from '../utils/deserializeHelpers.mjs';\nimport { assignStringVariables } from '../utils/serializeHelpers.mjs';\nimport { IntegrityError } from '../../../../../errors/IntegrityError.mjs';\nimport { defaultConfig, parseXmlError } from './base.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst listObjectsV2Serializer = (input, endpoint) => {\n  const headers = assignStringVariables({\n    'x-amz-request-payer': input.RequestPayer,\n    'x-amz-expected-bucket-owner': input.ExpectedBucketOwner\n  });\n  const query = assignStringVariables({\n    'list-type': '2',\n    'continuation-token': input.ContinuationToken,\n    delimiter: input.Delimiter,\n    'encoding-type': input.EncodingType,\n    'fetch-owner': input.FetchOwner,\n    'max-keys': input.MaxKeys,\n    prefix: input.Prefix,\n    'start-after': input.StartAfter\n  });\n  const url = new AmplifyUrl(endpoint.url.toString());\n  url.search = new AmplifyUrlSearchParams(query).toString();\n  return {\n    method: 'GET',\n    headers,\n    url\n  };\n};\nconst listObjectsV2Deserializer = async response => {\n  if (response.statusCode >= 300) {\n    // error is always set when statusCode >= 300\n    throw buildStorageServiceError(await parseXmlError(response));\n  } else {\n    const parsed = await parseXmlBody(response);\n    const contents = map(parsed, {\n      CommonPrefixes: ['CommonPrefixes', value => emptyArrayGuard(value, deserializeCommonPrefixList)],\n      Contents: ['Contents', value => emptyArrayGuard(value, deserializeObjectList)],\n      ContinuationToken: 'ContinuationToken',\n      Delimiter: 'Delimiter',\n      EncodingType: ['EncodingType', deserializeStringTag],\n      IsTruncated: ['IsTruncated', deserializeBoolean],\n      KeyCount: ['KeyCount', deserializeNumber],\n      MaxKeys: ['MaxKeys', deserializeNumber],\n      Name: 'Name',\n      NextContinuationToken: 'NextContinuationToken',\n      Prefix: 'Prefix',\n      StartAfter: 'StartAfter'\n    });\n    const output = _objectSpread({\n      $metadata: parseMetadata(response)\n    }, contents);\n    validateCorroboratingElements(output);\n    return output;\n  }\n};\nconst deserializeCommonPrefixList = output => output.map(deserializeCommonPrefix);\nconst deserializeCommonPrefix = output => map(output, {\n  Prefix: 'Prefix'\n});\nconst deserializeObjectList = output => output.map(deserializeObject);\nconst deserializeObject = output => map(output, {\n  Key: 'Key',\n  LastModified: ['LastModified', deserializeTimestamp],\n  ETag: 'ETag',\n  ChecksumAlgorithm: ['ChecksumAlgorithm', value => emptyArrayGuard(value, deserializeChecksumAlgorithmList)],\n  ChecksumType: ['ChecksumType', deserializeStringTag],\n  Size: ['Size', deserializeNumber],\n  StorageClass: ['StorageClass', deserializeStringTag],\n  Owner: ['Owner', deserializeOwner]\n});\nconst deserializeChecksumAlgorithmList = output => output.map(deserializeStringTag);\nconst deserializeOwner = output => map(output, {\n  DisplayName: 'DisplayName',\n  ID: 'ID'\n});\nconst validateCorroboratingElements = response => {\n  const {\n    IsTruncated,\n    KeyCount,\n    Contents = [],\n    CommonPrefixes = [],\n    NextContinuationToken\n  } = response;\n  const validTruncation = IsTruncated && !!NextContinuationToken || !IsTruncated && !NextContinuationToken;\n  const validNumberOfKeysReturned = KeyCount === Contents.length + CommonPrefixes.length;\n  if (!validTruncation || !validNumberOfKeysReturned) {\n    throw new IntegrityError({\n      metadata: response.$metadata\n    });\n  }\n};\nconst listObjectsV2 = composeServiceApi(s3TransferHandler, listObjectsV2Serializer, listObjectsV2Deserializer, _objectSpread(_objectSpread({}, defaultConfig), {}, {\n  responseType: 'text'\n}));\nexport { listObjectsV2 };","map":{"version":3,"names":["listObjectsV2Serializer","input","endpoint","headers","assignStringVariables","RequestPayer","ExpectedBucketOwner","query","ContinuationToken","delimiter","Delimiter","EncodingType","FetchOwner","MaxKeys","prefix","Prefix","StartAfter","url","AmplifyUrl","toString","search","AmplifyUrlSearchParams","method","listObjectsV2Deserializer","response","statusCode","buildStorageServiceError","parseXmlError","parsed","parseXmlBody","contents","map","CommonPrefixes","value","emptyArrayGuard","deserializeCommonPrefixList","Contents","deserializeObjectList","deserializeStringTag","IsTruncated","deserializeBoolean","KeyCount","deserializeNumber","Name","NextContinuationToken","output","_objectSpread","$metadata","parseMetadata","validateCorroboratingElements","deserializeCommonPrefix","deserializeObject","Key","LastModified","deserializeTimestamp","ETag","ChecksumAlgorithm","deserializeChecksumAlgorithmList","ChecksumType","Size","StorageClass","Owner","deserializeOwner","DisplayName","ID","validTruncation","validNumberOfKeysReturned","length","IntegrityError","metadata","listObjectsV2","composeServiceApi","s3TransferHandler","defaultConfig","responseType"],"sources":["/Users/saisaran/Desktop/BirdTag/UI/node_modules/@aws-amplify/storage/src/providers/s3/utils/client/s3data/listObjectsV2.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { parseMetadata, } from '@aws-amplify/core/internals/aws-client-utils';\nimport { AmplifyUrl, AmplifyUrlSearchParams, } from '@aws-amplify/core/internals/utils';\nimport { composeServiceApi } from '@aws-amplify/core/internals/aws-client-utils/composers';\nimport { assignStringVariables, buildStorageServiceError, deserializeBoolean, deserializeNumber, deserializeTimestamp, emptyArrayGuard, map, parseXmlBody, s3TransferHandler, } from '../utils';\nimport { IntegrityError } from '../../../../../errors/IntegrityError';\nimport { deserializeStringTag } from '../utils/deserializeHelpers';\nimport { defaultConfig, parseXmlError } from './base';\nconst listObjectsV2Serializer = (input, endpoint) => {\n    const headers = assignStringVariables({\n        'x-amz-request-payer': input.RequestPayer,\n        'x-amz-expected-bucket-owner': input.ExpectedBucketOwner,\n    });\n    const query = assignStringVariables({\n        'list-type': '2',\n        'continuation-token': input.ContinuationToken,\n        delimiter: input.Delimiter,\n        'encoding-type': input.EncodingType,\n        'fetch-owner': input.FetchOwner,\n        'max-keys': input.MaxKeys,\n        prefix: input.Prefix,\n        'start-after': input.StartAfter,\n    });\n    const url = new AmplifyUrl(endpoint.url.toString());\n    url.search = new AmplifyUrlSearchParams(query).toString();\n    return {\n        method: 'GET',\n        headers,\n        url,\n    };\n};\nconst listObjectsV2Deserializer = async (response) => {\n    if (response.statusCode >= 300) {\n        // error is always set when statusCode >= 300\n        throw buildStorageServiceError((await parseXmlError(response)));\n    }\n    else {\n        const parsed = await parseXmlBody(response);\n        const contents = map(parsed, {\n            CommonPrefixes: [\n                'CommonPrefixes',\n                value => emptyArrayGuard(value, deserializeCommonPrefixList),\n            ],\n            Contents: [\n                'Contents',\n                value => emptyArrayGuard(value, deserializeObjectList),\n            ],\n            ContinuationToken: 'ContinuationToken',\n            Delimiter: 'Delimiter',\n            EncodingType: ['EncodingType', (deserializeStringTag)],\n            IsTruncated: ['IsTruncated', deserializeBoolean],\n            KeyCount: ['KeyCount', deserializeNumber],\n            MaxKeys: ['MaxKeys', deserializeNumber],\n            Name: 'Name',\n            NextContinuationToken: 'NextContinuationToken',\n            Prefix: 'Prefix',\n            StartAfter: 'StartAfter',\n        });\n        const output = {\n            $metadata: parseMetadata(response),\n            ...contents,\n        };\n        validateCorroboratingElements(output);\n        return output;\n    }\n};\nconst deserializeCommonPrefixList = (output) => output.map(deserializeCommonPrefix);\nconst deserializeCommonPrefix = (output) => map(output, {\n    Prefix: 'Prefix',\n});\nconst deserializeObjectList = (output) => output.map(deserializeObject);\nconst deserializeObject = (output) => map(output, {\n    Key: 'Key',\n    LastModified: ['LastModified', deserializeTimestamp],\n    ETag: 'ETag',\n    ChecksumAlgorithm: [\n        'ChecksumAlgorithm',\n        value => emptyArrayGuard(value, deserializeChecksumAlgorithmList),\n    ],\n    ChecksumType: ['ChecksumType', (deserializeStringTag)],\n    Size: ['Size', deserializeNumber],\n    StorageClass: ['StorageClass', (deserializeStringTag)],\n    Owner: ['Owner', deserializeOwner],\n});\nconst deserializeChecksumAlgorithmList = (output) => output.map((deserializeStringTag));\nconst deserializeOwner = (output) => map(output, { DisplayName: 'DisplayName', ID: 'ID' });\nconst validateCorroboratingElements = (response) => {\n    const { IsTruncated, KeyCount, Contents = [], CommonPrefixes = [], NextContinuationToken, } = response;\n    const validTruncation = (IsTruncated && !!NextContinuationToken) ||\n        (!IsTruncated && !NextContinuationToken);\n    const validNumberOfKeysReturned = KeyCount === Contents.length + CommonPrefixes.length;\n    if (!validTruncation || !validNumberOfKeysReturned) {\n        throw new IntegrityError({ metadata: response.$metadata });\n    }\n};\nexport const listObjectsV2 = composeServiceApi(s3TransferHandler, listObjectsV2Serializer, listObjectsV2Deserializer, { ...defaultConfig, responseType: 'text' });\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}