{"ast":null,"code":"import _objectSpread from\"/Users/saisaran/Desktop/BirdTag/UI/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import'./Search.css';// Media thumbnail component that handles images, videos, and audio\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MediaThumbnail=_ref=>{let{url,index,onMediaClick,width=150}=_ref;const[imageError,setImageError]=useState(false);const[mediaType,setMediaType]=useState(null);// Detect media type from URL or file extension\nconst detectMediaType=url=>{if(!url)return'unknown';const lowerUrl=url.toLowerCase();// Image formats\nif(lowerUrl.includes('.jpg')||lowerUrl.includes('.jpeg')||lowerUrl.includes('.png')||lowerUrl.includes('.gif')||lowerUrl.includes('.webp')||lowerUrl.includes('.bmp')){return'image';}// Video formats\nif(lowerUrl.includes('.mp4')||lowerUrl.includes('.mov')||lowerUrl.includes('.avi')||lowerUrl.includes('.mkv')||lowerUrl.includes('.webm')||lowerUrl.includes('.quicktime')){return'video';}// Audio formats\nif(lowerUrl.includes('.mp3')||lowerUrl.includes('.wav')||lowerUrl.includes('.ogg')||lowerUrl.includes('.m4a')||lowerUrl.includes('.flac')||lowerUrl.includes('.aac')){return'audio';}return'unknown';};const currentMediaType=mediaType||detectMediaType(url);const handleImageError=()=>{setImageError(true);// Try to detect media type if image fails to load\nconst detectedType=detectMediaType(url);setMediaType(detectedType);};const renderImageThumbnail=()=>/*#__PURE__*/_jsx(\"img\",{src:url,alt:\"thumbnail-\".concat(index),width:width,className:\"media-thumbnail media-thumbnail-image\",style:{height:width*0.75},onClick:()=>onMediaClick(url),onError:handleImageError});const renderVideoThumbnail=()=>{// Try to get the original video URL for thumbnail generation\nconst originalUrl=url.replace('/thumbnails/','/');return/*#__PURE__*/_jsxs(\"div\",{className:\"media-placeholder media-placeholder-video\",style:{width:width,height:width*0.75},onClick:()=>onMediaClick(originalUrl),children:[/*#__PURE__*/_jsx(\"svg\",{width:\"48\",height:\"48\",viewBox:\"0 0 24 24\",fill:\"#666\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M8 5v14l11-7z\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"media-label media-label-video\",children:\"VIDEO\"}),/*#__PURE__*/_jsx(\"video\",{className:\"video-overlay\",muted:true,preload:\"metadata\",onLoadedMetadata:e=>{// Set current time to 1 second to get a frame\ne.target.currentTime=1;},children:/*#__PURE__*/_jsx(\"source\",{src:originalUrl})})]});};const renderAudioThumbnail=()=>{const originalUrl=url.replace('/thumbnails/','/');return/*#__PURE__*/_jsxs(\"div\",{className:\"media-placeholder media-placeholder-audio\",style:{width:width,height:width*0.75},onClick:()=>onMediaClick(originalUrl),children:[/*#__PURE__*/_jsx(\"svg\",{width:\"48\",height:\"48\",viewBox:\"0 0 24 24\",fill:\"#4a90e2\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"media-label media-label-audio\",children:\"AUDIO\"}),/*#__PURE__*/_jsx(\"div\",{className:\"audio-waveform\",children:[12,20,8,16,24,10,18,14,22,6,16,12].map((height,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"waveform-bar\",style:{height:\"\".concat(height,\"px\")}},i))})]});};const renderUnknownThumbnail=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"media-placeholder media-placeholder-unknown\",style:{width:width,height:width*0.75},onClick:()=>onMediaClick(url),children:[/*#__PURE__*/_jsx(\"svg\",{width:\"48\",height:\"48\",viewBox:\"0 0 24 24\",fill:\"#999\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"media-label media-label-unknown\",children:\"FILE\"})]});// Render based on media type\nif(!imageError&&(currentMediaType==='image'||currentMediaType==='unknown')){return renderImageThumbnail();}else if(currentMediaType==='video'){return renderVideoThumbnail();}else if(currentMediaType==='audio'){return renderAudioThumbnail();}else{return renderUnknownThumbnail();}};// Fixed Mini Gallery for thumbnail selection with better image filtering\nconst ThumbnailSelector=_ref2=>{let{onSelectThumbnail,onClose,showOnlyImages=false}=_ref2;const[mediaItems,setMediaItems]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[searchTag,setSearchTag]=useState('');const apiBase='https://5myucif3s8.execute-api.us-east-1.amazonaws.com/dev';useEffect(()=>{fetchGallery();},[]);const fetchGallery=async()=>{setLoading(true);try{var _tokens$idToken;const{fetchAuthSession}=await import('aws-amplify/auth');const{tokens}=await fetchAuthSession();const idToken=tokens===null||tokens===void 0?void 0:(_tokens$idToken=tokens.idToken)===null||_tokens$idToken===void 0?void 0:_tokens$idToken.toString();if(!idToken){throw new Error('Authentication token not available');}const res=await fetch(\"\".concat(apiBase,\"/show-gallery\"),{method:'GET',headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(idToken)}});if(!res.ok){throw new Error(\"Fetch failed: \".concat(res.status));}const data=await res.json();const allItems=transformGalleryData(data.gallery||{},showOnlyImages);setMediaItems(allItems);setError('');}catch(err){console.error('Error fetching gallery:',err);setError('Failed to load gallery.');}finally{setLoading(false);}};// FIXED: Better image filtering logic\nconst transformGalleryData=function(gallery){let showOnlyImages=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;const allItems=[];// Process all categories to find items\n['images','audio','video','other'].forEach(fileType=>{if(gallery[fileType]&&Array.isArray(gallery[fileType])){gallery[fileType].forEach(item=>{const tagsArray=transformTags(item.tags||{});const transformedItem={url:item.url,file_type:item.file_type,file_id:item.file_id,tags:tagsArray,tagsObject:item.tags||{}};// If showOnlyImages is true, filter by actual file type instead of category\nif(showOnlyImages){const fileTypeStr=(item.file_type||'').toLowerCase();const urlStr=(item.url||'').toLowerCase();// Check if it's actually an image by file type or URL\nconst isImage=fileTypeStr.startsWith('image/')||urlStr.includes('.jpg')||urlStr.includes('.jpeg')||urlStr.includes('.png')||urlStr.includes('.gif')||urlStr.includes('.webp')||urlStr.includes('.bmp')||urlStr.includes('/thumbnails/');// Thumbnails are usually images\nif(isImage){allItems.push(transformedItem);}}else{// Include all items if not filtering for images only\nallItems.push(transformedItem);}});}});return allItems;};const transformTags=tagsObject=>{if(!tagsObject||typeof tagsObject!=='object'){return[];}return Object.entries(tagsObject).map(_ref3=>{let[species,count]=_ref3;return count>1?\"\".concat(species,\" (\").concat(count,\")\"):species;});};const handleThumbnailClick=url=>{onSelectThumbnail(url);onClose();};const filteredItems=searchTag?mediaItems.filter(item=>{var _item$tags;const searchLower=searchTag.toLowerCase();const matchesDisplayTags=(_item$tags=item.tags)===null||_item$tags===void 0?void 0:_item$tags.some(tag=>tag.toLowerCase().includes(searchLower));const matchesOriginalTags=Object.keys(item.tagsObject||{}).some(species=>species.toLowerCase().includes(searchLower));return matchesDisplayTags||matchesOriginalTags;}):mediaItems;return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:showOnlyImages?'Select an Image Thumbnail for Reverse Lookup':'Select a Thumbnail for Reverse Lookup'}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"btn btn-danger\",children:\"Close\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-search\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Filter by bird species...\",value:searchTag,onChange:e=>setSearchTag(e.target.value)}),showOnlyImages&&/*#__PURE__*/_jsxs(\"div\",{className:\"modal-info\",children:[\"Showing images only (reverse lookup works with image thumbnails)\",/*#__PURE__*/_jsx(\"br\",{}),\"Found \",filteredItems.length,\" image\",filteredItems.length!==1?'s':'']})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-display\",children:error}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-display\",children:\"Loading gallery...\"}),/*#__PURE__*/_jsx(\"div\",{className:\"thumbnails-grid\",children:filteredItems.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"thumbnail-item\",onClick:()=>handleThumbnailClick(item.url),children:[/*#__PURE__*/_jsx(\"img\",{src:item.url,alt:\"thumbnail\",className:\"thumbnail-image\",onError:e=>{// If image fails, show a placeholder\ne.target.style.display='none';e.target.nextElementSibling.style.display='flex';}}),/*#__PURE__*/_jsxs(\"div\",{className:\"thumbnail-fallback\",children:[/*#__PURE__*/_jsx(\"svg\",{width:\"32\",height:\"32\",viewBox:\"0 0 24 24\",fill:\"#999\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"media-label media-label-unknown\",children:item.file_type||'FILE'})]}),item.tags&&item.tags.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"thumbnail-tags\",children:[item.tags.slice(0,2).join(', '),item.tags.length>2&&'...']})]},item.file_id||index))}),filteredItems.length===0&&!loading&&/*#__PURE__*/_jsx(\"p\",{className:\"no-results\",children:showOnlyImages?'No matching images found. Images might be categorized differently in the system.':'No matching files found.'})]})});};// Enhanced Search component with navigation to bulk tagging and delete files\nconst Search=_ref4=>{let{onNavigateToBulkTagging,onNavigateToDeleteFiles}=_ref4;const[tags,setTags]=useState([{tag:'',count:1}]);const[speciesList,setSpeciesList]=useState(['']);const[thumbUrl,setThumbUrl]=useState('');const[queryFile,setQueryFile]=useState(null);const[results,setResults]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[fileUploadStatus,setFileUploadStatus]=useState('');const[showThumbnailSelector,setShowThumbnailSelector]=useState(false);const apiBase='https://5myucif3s8.execute-api.us-east-1.amazonaws.com/dev';// Enhanced media click handler\nconst handleMediaClick=async mediaUrl=>{try{var _tokens$idToken2;setLoading(true);setError('');const{fetchAuthSession}=await import('@aws-amplify/auth');const{tokens}=await fetchAuthSession();const token=tokens===null||tokens===void 0?void 0:(_tokens$idToken2=tokens.idToken)===null||_tokens$idToken2===void 0?void 0:_tokens$idToken2.toString();if(!token){throw new Error('Authentication token not available');}console.log('Opening media:',mediaUrl);// If it's already a full URL, open it directly\nif(mediaUrl.includes('/thumbnails/')){// Try to get the original file URL\ntry{const response=await fetch(\"\".concat(apiBase,\"/search/by-thumbnail-url?thumbnail_url=\").concat(encodeURIComponent(mediaUrl)),{method:'GET',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'}});if(response.ok){const data=await response.json();if(data.original_url){window.open(data.original_url,'_blank');return;}}}catch(err){console.error('API lookup failed, trying fallback:',err);}// Fallback: construct original URL\nconst originalUrl=mediaUrl.replace('/thumbnails/','/');window.open(originalUrl,'_blank');}else{// It's already the original URL\nwindow.open(mediaUrl,'_blank');}}catch(err){console.error('Media click failed:',err);setError(\"Error opening media: \".concat(err.message));}finally{setLoading(false);}};const handleTagChange=(index,field,value)=>{const newTags=[...tags];newTags[index][field]=field==='count'?parseInt(value):value.toLowerCase();setTags(newTags);};const addTagField=()=>setTags([...tags,{tag:'',count:1}]);const removeTagField=index=>setTags(tags.filter((_,i)=>i!==index));const sendPost=async function(url,payload){let isFile=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;setLoading(true);setError('');setResults([]);try{var _tokens$idToken3;const{fetchAuthSession}=await import('@aws-amplify/auth');const{tokens}=await fetchAuthSession();const token=tokens===null||tokens===void 0?void 0:(_tokens$idToken3=tokens.idToken)===null||_tokens$idToken3===void 0?void 0:_tokens$idToken3.toString();if(!token){throw new Error('Authentication token not available');}const headers=_objectSpread({'Authorization':\"Bearer \".concat(token)},isFile?{}:{'Content-Type':'application/json'});const response=await fetch(url,{method:'POST',headers,body:isFile?payload:JSON.stringify(payload)});if(!response.ok){const errorText=await response.text();throw new Error(\"Error \".concat(response.status,\": \").concat(errorText));}const data=await response.json();setResults(data.links||[]);}catch(err){console.error('sendPost error:',err);setError(err.message);}finally{setLoading(false);}};const sendGet=async url=>{setLoading(true);setError('');setResults([]);try{var _tokens$idToken4;const{fetchAuthSession}=await import('@aws-amplify/auth');const{tokens}=await fetchAuthSession();const token=tokens===null||tokens===void 0?void 0:(_tokens$idToken4=tokens.idToken)===null||_tokens$idToken4===void 0?void 0:_tokens$idToken4.toString();if(!token){throw new Error('Authentication token not available');}const response=await fetch(url,{method:'GET',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'}});if(!response.ok){const errorText=await response.text();throw new Error(\"Error \".concat(response.status,\": \").concat(errorText));}const data=await response.json();setResults(data.links||[]);}catch(err){console.error('sendGet error:',err);setError(err.message);}finally{setLoading(false);}};const runTagCountQuery=()=>{const query=Object.fromEntries(tags.map(_ref5=>{let{tag,count}=_ref5;return[tag,count];}));sendPost(\"\".concat(apiBase,\"/search/by-tags\"),query);};const runSpeciesQuery=()=>{if(speciesList.length===0||speciesList.every(s=>!s.trim())){setError('Please enter at least one species name');return;}const queryParams=speciesList.filter(s=>s.trim()).map((s,i)=>\"species\".concat(speciesList.length>1?i+1:'',\"=\").concat(encodeURIComponent(s))).join('&');const fullUrl=\"\".concat(apiBase,\"/search/by-species-no-count?\").concat(queryParams);sendGet(fullUrl);};const runFileQuery=async()=>{if(!queryFile){setError('Please select a file first');return;}setLoading(true);setError('');setResults([]);setFileUploadStatus('Getting upload URL...');try{var _tokens$idToken5;const{fetchAuthSession}=await import('@aws-amplify/auth');const{tokens}=await fetchAuthSession();const token=tokens===null||tokens===void 0?void 0:(_tokens$idToken5=tokens.idToken)===null||_tokens$idToken5===void 0?void 0:_tokens$idToken5.toString();// Step 1: Get temporary upload URL\nsetFileUploadStatus('Getting upload URL...');const uploadResponse=await fetch(\"\".concat(apiBase,\"/upload\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'},body:JSON.stringify({fileName:queryFile.name,fileType:queryFile.type,temporary:true// IMPORTANT: This makes it temporary\n})});if(!uploadResponse.ok){const error=await uploadResponse.json();throw new Error(error.error||'Failed to get upload URL');}const uploadData=await uploadResponse.json();console.log('Upload response data:',uploadData);// Verify we have the required field for search\nif(!uploadData.s3Key){throw new Error('Upload response missing s3Key');}// Step 2: Upload file to S3\nsetFileUploadStatus('Uploading file for analysis...');const s3Response=await fetch(uploadData.uploadUrl,{method:'PUT',headers:{'Content-Type':queryFile.type},body:queryFile});if(!s3Response.ok){throw new Error('Failed to upload file');}// Step 3: Search for matching files\nsetFileUploadStatus('Detecting birds and finding matches... (this may take up to 30 seconds)');// The /search/by-file-tag endpoint only expects s3Key\nconst searchPayload={s3Key:uploadData.s3Key};console.log('Search payload:',searchPayload);const searchResponse=await fetch(\"\".concat(apiBase,\"/search/by-file-tag\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'},body:JSON.stringify(searchPayload)});if(!searchResponse.ok){const errorData=await searchResponse.json();throw new Error(errorData.error||'Search failed');}const results=await searchResponse.json();// Step 4: Show results\nsetResults(results.links||[]);const birdTypes=Object.keys(results.detected_tags||{}).join(', ');setFileUploadStatus(\"Found \".concat(results.match_count||0,\" files with similar birds: \").concat(birdTypes));}catch(err){setError(err.message);setFileUploadStatus('');}finally{setLoading(false);}};const handleSelectThumbnail=url=>{// Strip query parameters from presigned URLs\nconst cleanUrl=url.split('?')[0];// UPDATED: Handle cross-bucket conversion\nlet thumbnailUrl=cleanUrl;if(cleanUrl.includes('/media/images/')){// Extract filename from original URL\nconst filename=cleanUrl.split('/').pop();// Create thumbnail URL in different bucket\nthumbnailUrl=\"https://thumbnailbucket134.s3.amazonaws.com/thumbnails/\".concat(filename);}setThumbUrl(thumbnailUrl);// Automatically run the reverse lookup with thumbnail URL\nsendGet(\"\".concat(apiBase,\"/search/by-thumbnail-url?thumbnail_url=\").concat(encodeURIComponent(thumbnailUrl)));};return/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"search-main-title\",children:\"BirdTag Queries\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-display\",children:error}),/*#__PURE__*/_jsxs(\"section\",{className:\"search-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"1. Tag + Count Search\"}),tags.map((t,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"tag-input-row\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Tag (e.g., crow)\",value:t.tag,onChange:e=>handleTagChange(i,'tag',e.target.value),className:\"tag-input\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:t.count,onChange:e=>handleTagChange(i,'count',e.target.value),className:\"count-input\",min:\"1\"}),tags.length>1&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeTagField(i),className:\"btn btn-secondary btn-small\",children:\"Remove\"})]},i)),/*#__PURE__*/_jsx(\"button\",{onClick:addTagField,className:\"btn btn-secondary\",children:\"+ Add Tag\"}),/*#__PURE__*/_jsx(\"button\",{onClick:runTagCountQuery,className:\"btn btn-primary btn-add\",disabled:loading,children:\"Search\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"search-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"2. Search by Bird Species\"}),speciesList.map((s,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"tag-input-row\",children:[/*#__PURE__*/_jsx(\"input\",{value:s,placeholder:\"Species \".concat(i+1),onChange:e=>{const updated=[...speciesList];updated[i]=e.target.value.toLowerCase();setSpeciesList(updated);},className:\"species-input\"}),speciesList.length>1&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSpeciesList(speciesList.filter((_,index)=>index!==i)),className:\"btn btn-secondary btn-small\",children:\"Remove\"})]},i)),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSpeciesList([...speciesList,'']),className:\"btn btn-secondary\",children:\"+ Add Species\"}),/*#__PURE__*/_jsx(\"button\",{onClick:runSpeciesQuery,className:\"btn btn-primary btn-add\",disabled:loading,children:\"Search\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"search-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"3. Reverse Lookup from Thumbnail URL\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Find the original full-size image from any image URL.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"url-input-row\",children:[/*#__PURE__*/_jsx(\"input\",{value:thumbUrl,onChange:e=>setThumbUrl(e.target.value),placeholder:\"Paste any image URL or select from gallery\",className:\"url-input\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowThumbnailSelector(true),className:\"btn btn-success\",children:\"Select from Gallery\"})]}),thumbUrl&&thumbUrl.includes('/media/images/')&&/*#__PURE__*/_jsxs(\"div\",{className:\"converted-url-display\",children:[\"Will search using thumbnail URL: \",thumbUrl.replace('/media/images/','/media/thumbnails/')]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(!thumbUrl.trim()){setError('Please enter a thumbnail URL or select from gallery');return;}// Strip query parameters from presigned URLs\nlet cleanUrl=thumbUrl.split('?')[0];// Convert original image URL to thumbnail URL if needed\nif(cleanUrl.includes('/media/images/')){const filename=cleanUrl.split('/').pop();cleanUrl=\"https://thumbnailbucket134.s3.amazonaws.com/thumbnails/\".concat(filename);}sendGet(\"\".concat(apiBase,\"/search/by-thumbnail-url?thumbnail_url=\").concat(encodeURIComponent(cleanUrl)));},disabled:loading,className:\"btn btn-primary\",children:\"Find Full Image\"})]}),showThumbnailSelector&&/*#__PURE__*/_jsx(ThumbnailSelector,{onSelectThumbnail:handleSelectThumbnail,onClose:()=>setShowThumbnailSelector(false),showOnlyImages:true}),/*#__PURE__*/_jsxs(\"section\",{className:\"search-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"4. Upload File for Similar Tag Match\"}),/*#__PURE__*/_jsx(\"p\",{className:\"italic\",children:\"Your file is analyzed temporarily and not saved to your account\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:e=>setQueryFile(e.target.files[0]),accept:\"image/*,video/*,audio/*\",disabled:loading,className:\"file-input\"}),/*#__PURE__*/_jsx(\"button\",{onClick:runFileQuery,disabled:loading||!queryFile,className:\"btn btn-primary btn-add\",children:loading?'Processing...':'Find Similar Birds'}),fileUploadStatus&&/*#__PURE__*/_jsx(\"p\",{className:\"upload-status \".concat(loading?'loading':'success'),children:fileUploadStatus}),queryFile&&/*#__PURE__*/_jsxs(\"p\",{className:\"file-info\",children:[\"Selected: \",queryFile.name,\" (\",(queryFile.size/1024/1024).toFixed(1),\" MB)\",queryFile.type.startsWith('video/')&&' - Videos may take 20-30 seconds to process']})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"search-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"5. Delete Files\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Select multiple media files from your gallery and delete them permanently.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onNavigateToDeleteFiles,className:\"btn btn-danger btn-large\",children:\"Open Delete Files Gallery\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"search-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"6. Manual Bulk Tagging\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Select multiple media files from your gallery and add or remove tags in bulk.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onNavigateToBulkTagging,className:\"btn btn-success btn-large\",children:\"Open Bulk Tagging Gallery\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"results-section\",children:[loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-display\",children:\"Loading...\"}),results.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Results (\",results.length,\" found)\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"results-grid\",children:results.map((mediaUrl,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"result-item\",children:[/*#__PURE__*/_jsx(MediaThumbnail,{url:mediaUrl,index:i,onMediaClick:handleMediaClick,width:150}),/*#__PURE__*/_jsxs(\"div\",{className:\"result-index\",children:[\"#\",i+1]})]},i))})]})]})]});};export default Search;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","MediaThumbnail","_ref","url","index","onMediaClick","width","imageError","setImageError","mediaType","setMediaType","detectMediaType","lowerUrl","toLowerCase","includes","currentMediaType","handleImageError","detectedType","renderImageThumbnail","src","alt","concat","className","style","height","onClick","onError","renderVideoThumbnail","originalUrl","replace","children","viewBox","fill","d","muted","preload","onLoadedMetadata","e","target","currentTime","renderAudioThumbnail","map","i","renderUnknownThumbnail","ThumbnailSelector","_ref2","onSelectThumbnail","onClose","showOnlyImages","mediaItems","setMediaItems","loading","setLoading","error","setError","searchTag","setSearchTag","apiBase","fetchGallery","_tokens$idToken","fetchAuthSession","tokens","idToken","toString","Error","res","fetch","method","headers","Authorization","ok","status","data","json","allItems","transformGalleryData","gallery","err","console","arguments","length","undefined","forEach","fileType","Array","isArray","item","tagsArray","transformTags","tags","transformedItem","file_type","file_id","tagsObject","fileTypeStr","urlStr","isImage","startsWith","push","Object","entries","_ref3","species","count","handleThumbnailClick","filteredItems","filter","_item$tags","searchLower","matchesDisplayTags","some","tag","matchesOriginalTags","keys","type","placeholder","value","onChange","display","nextElementSibling","slice","join","Search","_ref4","onNavigateToBulkTagging","onNavigateToDeleteFiles","setTags","speciesList","setSpeciesList","thumbUrl","setThumbUrl","queryFile","setQueryFile","results","setResults","fileUploadStatus","setFileUploadStatus","showThumbnailSelector","setShowThumbnailSelector","handleMediaClick","mediaUrl","_tokens$idToken2","token","log","response","encodeURIComponent","original_url","window","open","message","handleTagChange","field","newTags","parseInt","addTagField","removeTagField","_","sendPost","payload","isFile","_tokens$idToken3","_objectSpread","body","JSON","stringify","errorText","text","links","sendGet","_tokens$idToken4","runTagCountQuery","query","fromEntries","_ref5","runSpeciesQuery","every","s","trim","queryParams","fullUrl","runFileQuery","_tokens$idToken5","uploadResponse","fileName","name","temporary","uploadData","s3Key","s3Response","uploadUrl","searchPayload","searchResponse","errorData","birdTypes","detected_tags","match_count","handleSelectThumbnail","cleanUrl","split","thumbnailUrl","filename","pop","t","min","disabled","updated","files","accept","size","toFixed"],"sources":["/Users/saisaran/Desktop/BirdTag/UI/src/Search.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './Search.css';\r\n\r\n// Media thumbnail component that handles images, videos, and audio\r\nconst MediaThumbnail = ({ url, index, onMediaClick, width = 150 }) => {\r\n  const [imageError, setImageError] = useState(false);\r\n  const [mediaType, setMediaType] = useState(null);\r\n\r\n  // Detect media type from URL or file extension\r\n  const detectMediaType = (url) => {\r\n    if (!url) return 'unknown';\r\n    \r\n    const lowerUrl = url.toLowerCase();\r\n    \r\n    // Image formats\r\n    if (lowerUrl.includes('.jpg') || lowerUrl.includes('.jpeg') || \r\n        lowerUrl.includes('.png') || lowerUrl.includes('.gif') || \r\n        lowerUrl.includes('.webp') || lowerUrl.includes('.bmp')) {\r\n      return 'image';\r\n    }\r\n    \r\n    // Video formats\r\n    if (lowerUrl.includes('.mp4') || lowerUrl.includes('.mov') || \r\n        lowerUrl.includes('.avi') || lowerUrl.includes('.mkv') || \r\n        lowerUrl.includes('.webm') || lowerUrl.includes('.quicktime')) {\r\n      return 'video';\r\n    }\r\n    \r\n    // Audio formats\r\n    if (lowerUrl.includes('.mp3') || lowerUrl.includes('.wav') || \r\n        lowerUrl.includes('.ogg') || lowerUrl.includes('.m4a') || \r\n        lowerUrl.includes('.flac') || lowerUrl.includes('.aac')) {\r\n      return 'audio';\r\n    }\r\n    \r\n    return 'unknown';\r\n  };\r\n\r\n  const currentMediaType = mediaType || detectMediaType(url);\r\n\r\n  const handleImageError = () => {\r\n    setImageError(true);\r\n    // Try to detect media type if image fails to load\r\n    const detectedType = detectMediaType(url);\r\n    setMediaType(detectedType);\r\n  };\r\n\r\n  const renderImageThumbnail = () => (\r\n    <img\r\n      src={url}\r\n      alt={`thumbnail-${index}`}\r\n      width={width}\r\n      className=\"media-thumbnail media-thumbnail-image\"\r\n      style={{ height: width * 0.75 }}\r\n      onClick={() => onMediaClick(url)}\r\n      onError={handleImageError}\r\n    />\r\n  );\r\n\r\n  const renderVideoThumbnail = () => {\r\n    // Try to get the original video URL for thumbnail generation\r\n    const originalUrl = url.replace('/thumbnails/', '/');\r\n    \r\n    return (\r\n      <div\r\n        className=\"media-placeholder media-placeholder-video\"\r\n        style={{ width: width, height: width * 0.75 }}\r\n        onClick={() => onMediaClick(originalUrl)}\r\n      >\r\n        {/* Video icon */}\r\n        <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"#666\">\r\n          <path d=\"M8 5v14l11-7z\"/>\r\n        </svg>\r\n        <div className=\"media-label media-label-video\">\r\n          VIDEO\r\n        </div>\r\n        \r\n        {/* Try to show actual video thumbnail if available */}\r\n        <video\r\n          className=\"video-overlay\"\r\n          muted\r\n          preload=\"metadata\"\r\n          onLoadedMetadata={(e) => {\r\n            // Set current time to 1 second to get a frame\r\n            e.target.currentTime = 1;\r\n          }}\r\n        >\r\n          <source src={originalUrl} />\r\n        </video>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderAudioThumbnail = () => {\r\n    const originalUrl = url.replace('/thumbnails/', '/');\r\n    \r\n    return (\r\n      <div\r\n        className=\"media-placeholder media-placeholder-audio\"\r\n        style={{ width: width, height: width * 0.75 }}\r\n        onClick={() => onMediaClick(originalUrl)}\r\n      >\r\n        {/* Audio waveform icon */}\r\n        <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"#4a90e2\">\r\n          <path d=\"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z\"/>\r\n        </svg>\r\n        <div className=\"media-label media-label-audio\">\r\n          AUDIO\r\n        </div>\r\n        \r\n        {/* Audio waveform visualization */}\r\n        <div className=\"audio-waveform\">\r\n          {[12, 20, 8, 16, 24, 10, 18, 14, 22, 6, 16, 12].map((height, i) => (\r\n            <div\r\n              key={i}\r\n              className=\"waveform-bar\"\r\n              style={{ height: `${height}px` }}\r\n            />\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderUnknownThumbnail = () => (\r\n    <div\r\n      className=\"media-placeholder media-placeholder-unknown\"\r\n      style={{ width: width, height: width * 0.75 }}\r\n      onClick={() => onMediaClick(url)}\r\n    >\r\n      <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"#999\">\r\n        <path d=\"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z\"/>\r\n      </svg>\r\n      <div className=\"media-label media-label-unknown\">\r\n        FILE\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // Render based on media type\r\n  if (!imageError && (currentMediaType === 'image' || currentMediaType === 'unknown')) {\r\n    return renderImageThumbnail();\r\n  } else if (currentMediaType === 'video') {\r\n    return renderVideoThumbnail();\r\n  } else if (currentMediaType === 'audio') {\r\n    return renderAudioThumbnail();\r\n  } else {\r\n    return renderUnknownThumbnail();\r\n  }\r\n};\r\n\r\n// Fixed Mini Gallery for thumbnail selection with better image filtering\r\nconst ThumbnailSelector = ({ onSelectThumbnail, onClose, showOnlyImages = false }) => {\r\n  const [mediaItems, setMediaItems] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [searchTag, setSearchTag] = useState('');\r\n\r\n  const apiBase = 'https://5myucif3s8.execute-api.us-east-1.amazonaws.com/dev';\r\n\r\n  useEffect(() => {\r\n    fetchGallery();\r\n  }, []);\r\n\r\n  const fetchGallery = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const { fetchAuthSession } = await import('aws-amplify/auth');\r\n      const { tokens } = await fetchAuthSession();\r\n      const idToken = tokens?.idToken?.toString();\r\n\r\n      if (!idToken) {\r\n        throw new Error('Authentication token not available');\r\n      }\r\n\r\n      const res = await fetch(`${apiBase}/show-gallery`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${idToken}`,\r\n        },\r\n      });\r\n\r\n      if (!res.ok) {\r\n        throw new Error(`Fetch failed: ${res.status}`);\r\n      }\r\n\r\n      const data = await res.json();\r\n      const allItems = transformGalleryData(data.gallery || {}, showOnlyImages);\r\n      setMediaItems(allItems);\r\n      setError('');\r\n    } catch (err) {\r\n      console.error('Error fetching gallery:', err);\r\n      setError('Failed to load gallery.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // FIXED: Better image filtering logic\r\n  const transformGalleryData = (gallery, showOnlyImages = false) => {\r\n    const allItems = [];\r\n    \r\n    // Process all categories to find items\r\n    ['images', 'audio', 'video', 'other'].forEach(fileType => {\r\n      if (gallery[fileType] && Array.isArray(gallery[fileType])) {\r\n        gallery[fileType].forEach(item => {\r\n          const tagsArray = transformTags(item.tags || {});\r\n          \r\n          const transformedItem = {\r\n            url: item.url,\r\n            file_type: item.file_type,\r\n            file_id: item.file_id,\r\n            tags: tagsArray,\r\n            tagsObject: item.tags || {}\r\n          };\r\n          \r\n          // If showOnlyImages is true, filter by actual file type instead of category\r\n          if (showOnlyImages) {\r\n            const fileTypeStr = (item.file_type || '').toLowerCase();\r\n            const urlStr = (item.url || '').toLowerCase();\r\n            \r\n            // Check if it's actually an image by file type or URL\r\n            const isImage = fileTypeStr.startsWith('image/') || \r\n                           urlStr.includes('.jpg') || urlStr.includes('.jpeg') || \r\n                           urlStr.includes('.png') || urlStr.includes('.gif') || \r\n                           urlStr.includes('.webp') || urlStr.includes('.bmp') ||\r\n                           urlStr.includes('/thumbnails/'); // Thumbnails are usually images\r\n            \r\n            if (isImage) {\r\n              allItems.push(transformedItem);\r\n            }\r\n          } else {\r\n            // Include all items if not filtering for images only\r\n            allItems.push(transformedItem);\r\n          }\r\n        });\r\n      }\r\n    });\r\n    \r\n    return allItems;\r\n  };\r\n\r\n  const transformTags = (tagsObject) => {\r\n    if (!tagsObject || typeof tagsObject !== 'object') {\r\n      return [];\r\n    }\r\n    \r\n    return Object.entries(tagsObject).map(([species, count]) => {\r\n      return count > 1 ? `${species} (${count})` : species;\r\n    });\r\n  };\r\n\r\n  const handleThumbnailClick = (url) => {\r\n    onSelectThumbnail(url);\r\n    onClose();\r\n  };\r\n\r\n  const filteredItems = searchTag\r\n    ? mediaItems.filter((item) => {\r\n        const searchLower = searchTag.toLowerCase();\r\n        \r\n        const matchesDisplayTags = item.tags?.some(tag =>\r\n          tag.toLowerCase().includes(searchLower)\r\n        );\r\n        \r\n        const matchesOriginalTags = Object.keys(item.tagsObject || {}).some(species =>\r\n          species.toLowerCase().includes(searchLower)\r\n        );\r\n        \r\n        return matchesDisplayTags || matchesOriginalTags;\r\n      })\r\n    : mediaItems;\r\n\r\n  return (\r\n    <div className=\"modal-overlay\">\r\n      <div className=\"modal-content\">\r\n        {/* Header */}\r\n        <div className=\"modal-header\">\r\n          <h3>\r\n            {showOnlyImages \r\n              ? 'Select an Image Thumbnail for Reverse Lookup' \r\n              : 'Select a Thumbnail for Reverse Lookup'\r\n            }\r\n          </h3>\r\n          <button \r\n            onClick={onClose}\r\n            className=\"btn btn-danger\"\r\n          >\r\n            Close\r\n          </button>\r\n        </div>\r\n\r\n        {/* Search */}\r\n        <div className=\"modal-search\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Filter by bird species...\"\r\n            value={searchTag}\r\n            onChange={(e) => setSearchTag(e.target.value)}\r\n          />\r\n          {showOnlyImages && (\r\n            <div className=\"modal-info\">\r\n              Showing images only (reverse lookup works with image thumbnails)\r\n              <br />\r\n              Found {filteredItems.length} image{filteredItems.length !== 1 ? 's' : ''}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Error */}\r\n        {error && (\r\n          <div className=\"error-display\">\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        {/* Loading */}\r\n        {loading && (\r\n          <div className=\"loading-display\">\r\n            Loading gallery...\r\n          </div>\r\n        )}\r\n\r\n        {/* Thumbnails grid */}\r\n        <div className=\"thumbnails-grid\">\r\n          {filteredItems.map((item, index) => (\r\n            <div \r\n              key={item.file_id || index}\r\n              className=\"thumbnail-item\"\r\n              onClick={() => handleThumbnailClick(item.url)}\r\n            >\r\n              {/* Simple thumbnail */}\r\n              <img\r\n                src={item.url}\r\n                alt=\"thumbnail\"\r\n                className=\"thumbnail-image\"\r\n                onError={(e) => {\r\n                  // If image fails, show a placeholder\r\n                  e.target.style.display = 'none';\r\n                  e.target.nextElementSibling.style.display = 'flex';\r\n                }}\r\n              />\r\n              \r\n              {/* Fallback placeholder */}\r\n              <div className=\"thumbnail-fallback\">\r\n                <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"#999\">\r\n                  <path d=\"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z\"/>\r\n                </svg>\r\n                <span className=\"media-label media-label-unknown\">\r\n                  {item.file_type || 'FILE'}\r\n                </span>\r\n              </div>\r\n\r\n              {/* Tags */}\r\n              {item.tags && item.tags.length > 0 && (\r\n                <div className=\"thumbnail-tags\">\r\n                  {item.tags.slice(0, 2).join(', ')}\r\n                  {item.tags.length > 2 && '...'}\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {filteredItems.length === 0 && !loading && (\r\n          <p className=\"no-results\">\r\n            {showOnlyImages \r\n              ? 'No matching images found. Images might be categorized differently in the system.'\r\n              : 'No matching files found.'\r\n            }\r\n          </p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Enhanced Search component with navigation to bulk tagging and delete files\r\nconst Search = ({ onNavigateToBulkTagging, onNavigateToDeleteFiles }) => {\r\n  const [tags, setTags] = useState([{ tag: '', count: 1 }]);\r\n  const [speciesList, setSpeciesList] = useState(['']);\r\n  const [thumbUrl, setThumbUrl] = useState('');\r\n  const [queryFile, setQueryFile] = useState(null);\r\n  const [results, setResults] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [fileUploadStatus, setFileUploadStatus] = useState('');\r\n  const [showThumbnailSelector, setShowThumbnailSelector] = useState(false);\r\n\r\n  const apiBase = 'https://5myucif3s8.execute-api.us-east-1.amazonaws.com/dev';\r\n\r\n  // Enhanced media click handler\r\n  const handleMediaClick = async (mediaUrl) => {\r\n    try {\r\n      setLoading(true);\r\n      setError('');\r\n      \r\n      const { fetchAuthSession } = await import('@aws-amplify/auth');\r\n      const { tokens } = await fetchAuthSession();\r\n      const token = tokens?.idToken?.toString();\r\n\r\n      if (!token) {\r\n        throw new Error('Authentication token not available');\r\n      }\r\n\r\n      console.log('Opening media:', mediaUrl);\r\n\r\n      // If it's already a full URL, open it directly\r\n      if (mediaUrl.includes('/thumbnails/')) {\r\n        // Try to get the original file URL\r\n        try {\r\n          const response = await fetch(\r\n            `${apiBase}/search/by-thumbnail-url?thumbnail_url=${encodeURIComponent(mediaUrl)}`,\r\n            {\r\n              method: 'GET',\r\n              headers: {\r\n                'Authorization': `Bearer ${token}`,\r\n                'Content-Type': 'application/json'\r\n              }\r\n            }\r\n          );\r\n\r\n          if (response.ok) {\r\n            const data = await response.json();\r\n            if (data.original_url) {\r\n              window.open(data.original_url, '_blank');\r\n              return;\r\n            }\r\n          }\r\n        } catch (err) {\r\n          console.error('API lookup failed, trying fallback:', err);\r\n        }\r\n        \r\n        // Fallback: construct original URL\r\n        const originalUrl = mediaUrl.replace('/thumbnails/', '/');\r\n        window.open(originalUrl, '_blank');\r\n      } else {\r\n        // It's already the original URL\r\n        window.open(mediaUrl, '_blank');\r\n      }\r\n    } catch (err) {\r\n      console.error('Media click failed:', err);\r\n      setError(`Error opening media: ${err.message}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleTagChange = (index, field, value) => {\r\n    const newTags = [...tags];\r\n    newTags[index][field] = field === 'count' ? parseInt(value) : value.toLowerCase();\r\n    setTags(newTags);\r\n  };\r\n\r\n  const addTagField = () => setTags([...tags, { tag: '', count: 1 }]);\r\n  const removeTagField = (index) => setTags(tags.filter((_, i) => i !== index));\r\n\r\n  const sendPost = async (url, payload, isFile = false) => {\r\n    setLoading(true);\r\n    setError('');\r\n    setResults([]);\r\n\r\n    try {\r\n      const { fetchAuthSession } = await import('@aws-amplify/auth');\r\n      const { tokens } = await fetchAuthSession();\r\n      const token = tokens?.idToken?.toString();\r\n      \r\n      if (!token) {\r\n        throw new Error('Authentication token not available');\r\n      }\r\n\r\n      const headers = {\r\n        'Authorization': `Bearer ${token}`,\r\n        ...(isFile ? {} : { 'Content-Type': 'application/json' })\r\n      };\r\n\r\n      const response = await fetch(url, {\r\n        method: 'POST',\r\n        headers,\r\n        body: isFile ? payload : JSON.stringify(payload)\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorText = await response.text();\r\n        throw new Error(`Error ${response.status}: ${errorText}`);\r\n      }\r\n      \r\n      const data = await response.json();\r\n      setResults(data.links || []);\r\n    } catch (err) {\r\n      console.error('sendPost error:', err);\r\n      setError(err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const sendGet = async (url) => {\r\n    setLoading(true);\r\n    setError('');\r\n    setResults([]);\r\n\r\n    try {\r\n      const { fetchAuthSession } = await import('@aws-amplify/auth');\r\n      const { tokens } = await fetchAuthSession();\r\n      const token = tokens?.idToken?.toString();\r\n      \r\n      if (!token) {\r\n        throw new Error('Authentication token not available');\r\n      }\r\n\r\n      const response = await fetch(url, {\r\n        method: 'GET',\r\n        headers: { \r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorText = await response.text();\r\n        throw new Error(`Error ${response.status}: ${errorText}`);\r\n      }\r\n      \r\n      const data = await response.json();\r\n      setResults(data.links || []);\r\n    } catch (err) {\r\n      console.error('sendGet error:', err);\r\n      setError(err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const runTagCountQuery = () => {\r\n    const query = Object.fromEntries(tags.map(({ tag, count }) => [tag, count]));\r\n    sendPost(`${apiBase}/search/by-tags`, query);\r\n  };\r\n\r\n  const runSpeciesQuery = () => {\r\n    if (speciesList.length === 0 || speciesList.every(s => !s.trim())) {\r\n      setError('Please enter at least one species name');\r\n      return;\r\n    }\r\n\r\n    const queryParams = speciesList\r\n      .filter(s => s.trim())\r\n      .map((s, i) => `species${speciesList.length > 1 ? i + 1 : ''}=${encodeURIComponent(s)}`)\r\n      .join('&');\r\n\r\n    const fullUrl = `${apiBase}/search/by-species-no-count?${queryParams}`;\r\n    sendGet(fullUrl);\r\n  };\r\n\r\n  const runFileQuery = async () => {\r\n    if (!queryFile) {\r\n      setError('Please select a file first');\r\n      return;\r\n    }\r\n    setLoading(true);\r\n    setError('');\r\n    setResults([]);\r\n    setFileUploadStatus('Getting upload URL...');\r\n    try {\r\n      const { fetchAuthSession } = await import('@aws-amplify/auth');\r\n      const { tokens } = await fetchAuthSession();\r\n      const token = tokens?.idToken?.toString();\r\n      // Step 1: Get temporary upload URL\r\n      setFileUploadStatus('Getting upload URL...');\r\n      const uploadResponse = await fetch(`${apiBase}/upload`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n          fileName: queryFile.name,\r\n          fileType: queryFile.type,\r\n          temporary: true  // IMPORTANT: This makes it temporary\r\n        })\r\n      });\r\n      if (!uploadResponse.ok) {\r\n        const error = await uploadResponse.json();\r\n        throw new Error(error.error || 'Failed to get upload URL');\r\n      }\r\n      const uploadData = await uploadResponse.json();\r\n      console.log('Upload response data:', uploadData);\r\n      \r\n      // Verify we have the required field for search\r\n      if (!uploadData.s3Key) {\r\n        throw new Error('Upload response missing s3Key');\r\n      }\r\n      \r\n      // Step 2: Upload file to S3\r\n      setFileUploadStatus('Uploading file for analysis...');\r\n      const s3Response = await fetch(uploadData.uploadUrl, {\r\n        method: 'PUT',\r\n        headers: { 'Content-Type': queryFile.type },\r\n        body: queryFile\r\n      });\r\n      if (!s3Response.ok) {\r\n        throw new Error('Failed to upload file');\r\n      }\r\n      \r\n      // Step 3: Search for matching files\r\n      setFileUploadStatus('Detecting birds and finding matches... (this may take up to 30 seconds)');\r\n      \r\n      // The /search/by-file-tag endpoint only expects s3Key\r\n      const searchPayload = { s3Key: uploadData.s3Key };\r\n      \r\n      console.log('Search payload:', searchPayload);\r\n      \r\n      const searchResponse = await fetch(`${apiBase}/search/by-file-tag`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(searchPayload)\r\n      });\r\n      if (!searchResponse.ok) {\r\n        const errorData = await searchResponse.json();\r\n        throw new Error(errorData.error || 'Search failed');\r\n      }\r\n      const results = await searchResponse.json();\r\n      // Step 4: Show results\r\n      setResults(results.links || []);\r\n      const birdTypes = Object.keys(results.detected_tags || {}).join(', ');\r\n      setFileUploadStatus(`Found ${results.match_count || 0} files with similar birds: ${birdTypes}`);\r\n    } catch (err) {\r\n      setError(err.message);\r\n      setFileUploadStatus('');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSelectThumbnail = (url) => {\r\n    // Strip query parameters from presigned URLs\r\n    const cleanUrl = url.split('?')[0];\r\n    \r\n    // UPDATED: Handle cross-bucket conversion\r\n    let thumbnailUrl = cleanUrl;\r\n    if (cleanUrl.includes('/media/images/')) {\r\n      // Extract filename from original URL\r\n      const filename = cleanUrl.split('/').pop();\r\n      // Create thumbnail URL in different bucket\r\n      thumbnailUrl = `https://thumbnailbucket134.s3.amazonaws.com/thumbnails/${filename}`;\r\n    }\r\n    \r\n    setThumbUrl(thumbnailUrl);\r\n    // Automatically run the reverse lookup with thumbnail URL\r\n    sendGet(`${apiBase}/search/by-thumbnail-url?thumbnail_url=${encodeURIComponent(thumbnailUrl)}`);\r\n  };\r\n\r\n  return (\r\n    <div className=\"search-container\">\r\n      <h2 className=\"search-main-title\">BirdTag Queries</h2>\r\n\r\n      {/* Error Display */}\r\n      {error && (\r\n        <div className=\"error-display\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {/* Tag + Count Search */}\r\n      <section className=\"search-section\">\r\n        <h4>1. Tag + Count Search</h4>\r\n        {tags.map((t, i) => (\r\n          <div key={i} className=\"tag-input-row\">\r\n            <input\r\n              placeholder=\"Tag (e.g., crow)\"\r\n              value={t.tag}\r\n              onChange={(e) => handleTagChange(i, 'tag', e.target.value)}\r\n              className=\"tag-input\"\r\n            />\r\n            <input\r\n              type=\"number\"\r\n              value={t.count}\r\n              onChange={(e) => handleTagChange(i, 'count', e.target.value)}\r\n              className=\"count-input\"\r\n              min=\"1\"\r\n            />\r\n            {tags.length > 1 && (\r\n              <button onClick={() => removeTagField(i)} className=\"btn btn-secondary btn-small\">\r\n                Remove\r\n              </button>\r\n            )}\r\n          </div>\r\n        ))}\r\n        <button onClick={addTagField} className=\"btn btn-secondary\">+ Add Tag</button>\r\n        <button onClick={runTagCountQuery} className=\"btn btn-primary btn-add\" disabled={loading}>\r\n          Search\r\n        </button>\r\n      </section>\r\n\r\n      {/* Multi-Species */}\r\n      <section className=\"search-section\">\r\n        <h4>2. Search by Bird Species</h4>\r\n        {speciesList.map((s, i) => (\r\n          <div key={i} className=\"tag-input-row\">\r\n            <input\r\n              value={s}\r\n              placeholder={`Species ${i + 1}`}\r\n              onChange={(e) => {\r\n                const updated = [...speciesList];\r\n                updated[i] = e.target.value.toLowerCase();\r\n                setSpeciesList(updated);\r\n              }}\r\n              className=\"species-input\"\r\n            />\r\n            {speciesList.length > 1 && (\r\n              <button \r\n                onClick={() => setSpeciesList(speciesList.filter((_, index) => index !== i))}\r\n                className=\"btn btn-secondary btn-small\"\r\n              >\r\n                Remove\r\n              </button>\r\n            )}\r\n          </div>\r\n        ))}\r\n        <button onClick={() => setSpeciesList([...speciesList, ''])} className=\"btn btn-secondary\">\r\n          + Add Species\r\n        </button>\r\n        <button onClick={runSpeciesQuery} className=\"btn btn-primary btn-add\" disabled={loading}>\r\n          Search\r\n        </button>\r\n      </section>\r\n\r\n      {/* Enhanced Reverse Lookup */}\r\n      <section className=\"search-section\">\r\n        <h4>3. Reverse Lookup from Thumbnail URL</h4>\r\n        <p>\r\n          Find the original full-size image from any image URL.\r\n        </p>\r\n        \r\n        <div className=\"url-input-row\">\r\n          <input\r\n            value={thumbUrl}\r\n            onChange={(e) => setThumbUrl(e.target.value)}\r\n            placeholder=\"Paste any image URL or select from gallery\"\r\n            className=\"url-input\"\r\n          />\r\n          \r\n          <button \r\n            onClick={() => setShowThumbnailSelector(true)}\r\n            className=\"btn btn-success\"\r\n          >\r\n            Select from Gallery\r\n          </button>\r\n        </div>\r\n        \r\n        {/* Show converted URL if it was modified */}\r\n        {thumbUrl && thumbUrl.includes('/media/images/') && (\r\n          <div className=\"converted-url-display\">\r\n            Will search using thumbnail URL: {thumbUrl.replace('/media/images/', '/media/thumbnails/')}\r\n          </div>\r\n        )}\r\n        \r\n        <button \r\n          onClick={() => {\r\n            if (!thumbUrl.trim()) {\r\n              setError('Please enter a thumbnail URL or select from gallery');\r\n              return;\r\n            }\r\n            // Strip query parameters from presigned URLs\r\n            let cleanUrl = thumbUrl.split('?')[0];\r\n            \r\n            // Convert original image URL to thumbnail URL if needed\r\n            if (cleanUrl.includes('/media/images/')) {\r\n              const filename = cleanUrl.split('/').pop();\r\n              cleanUrl = `https://thumbnailbucket134.s3.amazonaws.com/thumbnails/${filename}`;\r\n            }\r\n            \r\n            sendGet(`${apiBase}/search/by-thumbnail-url?thumbnail_url=${encodeURIComponent(cleanUrl)}`);\r\n          }} \r\n          disabled={loading}\r\n          className=\"btn btn-primary\"\r\n        >\r\n          Find Full Image\r\n        </button>\r\n      </section>\r\n\r\n      {/* Thumbnail Selector Modal */}\r\n      {showThumbnailSelector && (\r\n        <ThumbnailSelector\r\n          onSelectThumbnail={handleSelectThumbnail}\r\n          onClose={() => setShowThumbnailSelector(false)}\r\n          showOnlyImages={true}\r\n        />\r\n      )}\r\n\r\n      {/* File Match */}\r\n      <section className=\"search-section\">\r\n        <h4>4. Upload File for Similar Tag Match</h4>\r\n        <p className=\"italic\">\r\n           Your file is analyzed temporarily and not saved to your account\r\n        </p>\r\n        \r\n        <input \r\n          type=\"file\" \r\n          onChange={(e) => setQueryFile(e.target.files[0])}\r\n          accept=\"image/*,video/*,audio/*\"\r\n          disabled={loading}\r\n          className=\"file-input\"\r\n        />\r\n        \r\n        <button \r\n          onClick={runFileQuery}\r\n          disabled={loading || !queryFile}\r\n          className=\"btn btn-primary btn-add\"\r\n        >\r\n          {loading ? 'Processing...' : 'Find Similar Birds'}\r\n        </button>\r\n        \r\n        {/* Show upload status */}\r\n        {fileUploadStatus && (\r\n          <p className={`upload-status ${loading ? 'loading' : 'success'}`}>\r\n            {fileUploadStatus}\r\n          </p>\r\n        )}\r\n        \r\n        {/* File info */}\r\n        {queryFile && (\r\n          <p className=\"file-info\">\r\n            Selected: {queryFile.name} ({(queryFile.size / 1024 / 1024).toFixed(1)} MB)\r\n            {queryFile.type.startsWith('video/') && ' - Videos may take 20-30 seconds to process'}\r\n          </p>\r\n        )}\r\n      </section>\r\n\r\n      {/* Delete */}\r\n      <section className=\"search-section\">\r\n        <h4>5. Delete Files</h4>\r\n        <p>\r\n          Select multiple media files from your gallery and delete them permanently.\r\n        </p>\r\n        \r\n        <button \r\n          onClick={onNavigateToDeleteFiles}\r\n          className=\"btn btn-danger btn-large\"\r\n        >\r\n          Open Delete Files Gallery\r\n        </button>\r\n      </section>\r\n\r\n      {/* Manual Bulk Tagging - Updated to navigation */}\r\n      <section className=\"search-section\">\r\n        <h4>6. Manual Bulk Tagging</h4>\r\n        <p>\r\n          Select multiple media files from your gallery and add or remove tags in bulk.\r\n        </p>\r\n        \r\n        <button \r\n          onClick={onNavigateToBulkTagging}\r\n          className=\"btn btn-success btn-large\"\r\n        >\r\n          Open Bulk Tagging Gallery\r\n        </button>\r\n      </section>\r\n\r\n      {/* Enhanced Results Display */}\r\n      <section className=\"results-section\">\r\n        {loading && (\r\n          <div className=\"loading-display\">\r\n            Loading...\r\n          </div>\r\n        )}\r\n        \r\n        {results.length > 0 && (\r\n          <div>\r\n            <h4>Results ({results.length} found)</h4>\r\n            <div className=\"results-grid\">\r\n              {results.map((mediaUrl, i) => (\r\n                <div key={i} className=\"result-item\">\r\n                  <MediaThumbnail\r\n                    url={mediaUrl}\r\n                    index={i}\r\n                    onMediaClick={handleMediaClick}\r\n                    width={150}\r\n                  />\r\n                  <div className=\"result-index\">\r\n                    #{i + 1}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </section>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Search;"],"mappings":"uHAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,cAAc,CAErB;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBACA,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAA+C,IAA9C,CAAEC,GAAG,CAAEC,KAAK,CAAEC,YAAY,CAAEC,KAAK,CAAG,GAAI,CAAC,CAAAJ,IAAA,CAC/D,KAAM,CAACK,UAAU,CAAEC,aAAa,CAAC,CAAGb,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAACc,SAAS,CAAEC,YAAY,CAAC,CAAGf,QAAQ,CAAC,IAAI,CAAC,CAEhD;AACA,KAAM,CAAAgB,eAAe,CAAIR,GAAG,EAAK,CAC/B,GAAI,CAACA,GAAG,CAAE,MAAO,SAAS,CAE1B,KAAM,CAAAS,QAAQ,CAAGT,GAAG,CAACU,WAAW,CAAC,CAAC,CAElC;AACA,GAAID,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,EAAIF,QAAQ,CAACE,QAAQ,CAAC,OAAO,CAAC,EACvDF,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,EAAIF,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,EACtDF,QAAQ,CAACE,QAAQ,CAAC,OAAO,CAAC,EAAIF,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,CAAE,CAC3D,MAAO,OAAO,CAChB,CAEA;AACA,GAAIF,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,EAAIF,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,EACtDF,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,EAAIF,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,EACtDF,QAAQ,CAACE,QAAQ,CAAC,OAAO,CAAC,EAAIF,QAAQ,CAACE,QAAQ,CAAC,YAAY,CAAC,CAAE,CACjE,MAAO,OAAO,CAChB,CAEA;AACA,GAAIF,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,EAAIF,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,EACtDF,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,EAAIF,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,EACtDF,QAAQ,CAACE,QAAQ,CAAC,OAAO,CAAC,EAAIF,QAAQ,CAACE,QAAQ,CAAC,MAAM,CAAC,CAAE,CAC3D,MAAO,OAAO,CAChB,CAEA,MAAO,SAAS,CAClB,CAAC,CAED,KAAM,CAAAC,gBAAgB,CAAGN,SAAS,EAAIE,eAAe,CAACR,GAAG,CAAC,CAE1D,KAAM,CAAAa,gBAAgB,CAAGA,CAAA,GAAM,CAC7BR,aAAa,CAAC,IAAI,CAAC,CACnB;AACA,KAAM,CAAAS,YAAY,CAAGN,eAAe,CAACR,GAAG,CAAC,CACzCO,YAAY,CAACO,YAAY,CAAC,CAC5B,CAAC,CAED,KAAM,CAAAC,oBAAoB,CAAGA,CAAA,gBAC3BpB,IAAA,QACEqB,GAAG,CAAEhB,GAAI,CACTiB,GAAG,cAAAC,MAAA,CAAejB,KAAK,CAAG,CAC1BE,KAAK,CAAEA,KAAM,CACbgB,SAAS,CAAC,uCAAuC,CACjDC,KAAK,CAAE,CAAEC,MAAM,CAAElB,KAAK,CAAG,IAAK,CAAE,CAChCmB,OAAO,CAAEA,CAAA,GAAMpB,YAAY,CAACF,GAAG,CAAE,CACjCuB,OAAO,CAAEV,gBAAiB,CAC3B,CACF,CAED,KAAM,CAAAW,oBAAoB,CAAGA,CAAA,GAAM,CACjC;AACA,KAAM,CAAAC,WAAW,CAAGzB,GAAG,CAAC0B,OAAO,CAAC,cAAc,CAAE,GAAG,CAAC,CAEpD,mBACE7B,KAAA,QACEsB,SAAS,CAAC,2CAA2C,CACrDC,KAAK,CAAE,CAAEjB,KAAK,CAAEA,KAAK,CAAEkB,MAAM,CAAElB,KAAK,CAAG,IAAK,CAAE,CAC9CmB,OAAO,CAAEA,CAAA,GAAMpB,YAAY,CAACuB,WAAW,CAAE,CAAAE,QAAA,eAGzChC,IAAA,QAAKQ,KAAK,CAAC,IAAI,CAACkB,MAAM,CAAC,IAAI,CAACO,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAAAF,QAAA,cACzDhC,IAAA,SAAMmC,CAAC,CAAC,eAAe,CAAC,CAAC,CACtB,CAAC,cACNnC,IAAA,QAAKwB,SAAS,CAAC,+BAA+B,CAAAQ,QAAA,CAAC,OAE/C,CAAK,CAAC,cAGNhC,IAAA,UACEwB,SAAS,CAAC,eAAe,CACzBY,KAAK,MACLC,OAAO,CAAC,UAAU,CAClBC,gBAAgB,CAAGC,CAAC,EAAK,CACvB;AACAA,CAAC,CAACC,MAAM,CAACC,WAAW,CAAG,CAAC,CAC1B,CAAE,CAAAT,QAAA,cAEFhC,IAAA,WAAQqB,GAAG,CAAES,WAAY,CAAE,CAAC,CACvB,CAAC,EACL,CAAC,CAEV,CAAC,CAED,KAAM,CAAAY,oBAAoB,CAAGA,CAAA,GAAM,CACjC,KAAM,CAAAZ,WAAW,CAAGzB,GAAG,CAAC0B,OAAO,CAAC,cAAc,CAAE,GAAG,CAAC,CAEpD,mBACE7B,KAAA,QACEsB,SAAS,CAAC,2CAA2C,CACrDC,KAAK,CAAE,CAAEjB,KAAK,CAAEA,KAAK,CAAEkB,MAAM,CAAElB,KAAK,CAAG,IAAK,CAAE,CAC9CmB,OAAO,CAAEA,CAAA,GAAMpB,YAAY,CAACuB,WAAW,CAAE,CAAAE,QAAA,eAGzChC,IAAA,QAAKQ,KAAK,CAAC,IAAI,CAACkB,MAAM,CAAC,IAAI,CAACO,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,SAAS,CAAAF,QAAA,cAC5DhC,IAAA,SAAMmC,CAAC,CAAC,6LAA6L,CAAC,CAAC,CACpM,CAAC,cACNnC,IAAA,QAAKwB,SAAS,CAAC,+BAA+B,CAAAQ,QAAA,CAAC,OAE/C,CAAK,CAAC,cAGNhC,IAAA,QAAKwB,SAAS,CAAC,gBAAgB,CAAAQ,QAAA,CAC5B,CAAC,EAAE,CAAE,EAAE,CAAE,CAAC,CAAE,EAAE,CAAE,EAAE,CAAE,EAAE,CAAE,EAAE,CAAE,EAAE,CAAE,EAAE,CAAE,CAAC,CAAE,EAAE,CAAE,EAAE,CAAC,CAACW,GAAG,CAAC,CAACjB,MAAM,CAAEkB,CAAC,gBAC5D5C,IAAA,QAEEwB,SAAS,CAAC,cAAc,CACxBC,KAAK,CAAE,CAAEC,MAAM,IAAAH,MAAA,CAAKG,MAAM,MAAK,CAAE,EAF5BkB,CAGN,CACF,CAAC,CACC,CAAC,EACH,CAAC,CAEV,CAAC,CAED,KAAM,CAAAC,sBAAsB,CAAGA,CAAA,gBAC7B3C,KAAA,QACEsB,SAAS,CAAC,6CAA6C,CACvDC,KAAK,CAAE,CAAEjB,KAAK,CAAEA,KAAK,CAAEkB,MAAM,CAAElB,KAAK,CAAG,IAAK,CAAE,CAC9CmB,OAAO,CAAEA,CAAA,GAAMpB,YAAY,CAACF,GAAG,CAAE,CAAA2B,QAAA,eAEjChC,IAAA,QAAKQ,KAAK,CAAC,IAAI,CAACkB,MAAM,CAAC,IAAI,CAACO,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAAAF,QAAA,cACzDhC,IAAA,SAAMmC,CAAC,CAAC,yFAAyF,CAAC,CAAC,CAChG,CAAC,cACNnC,IAAA,QAAKwB,SAAS,CAAC,iCAAiC,CAAAQ,QAAA,CAAC,MAEjD,CAAK,CAAC,EACH,CACN,CAED;AACA,GAAI,CAACvB,UAAU,GAAKQ,gBAAgB,GAAK,OAAO,EAAIA,gBAAgB,GAAK,SAAS,CAAC,CAAE,CACnF,MAAO,CAAAG,oBAAoB,CAAC,CAAC,CAC/B,CAAC,IAAM,IAAIH,gBAAgB,GAAK,OAAO,CAAE,CACvC,MAAO,CAAAY,oBAAoB,CAAC,CAAC,CAC/B,CAAC,IAAM,IAAIZ,gBAAgB,GAAK,OAAO,CAAE,CACvC,MAAO,CAAAyB,oBAAoB,CAAC,CAAC,CAC/B,CAAC,IAAM,CACL,MAAO,CAAAG,sBAAsB,CAAC,CAAC,CACjC,CACF,CAAC,CAED;AACA,KAAM,CAAAC,iBAAiB,CAAGC,KAAA,EAA4D,IAA3D,CAAEC,iBAAiB,CAAEC,OAAO,CAAEC,cAAc,CAAG,KAAM,CAAC,CAAAH,KAAA,CAC/E,KAAM,CAACI,UAAU,CAAEC,aAAa,CAAC,CAAGvD,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACwD,OAAO,CAAEC,UAAU,CAAC,CAAGzD,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAC0D,KAAK,CAAEC,QAAQ,CAAC,CAAG3D,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAAC4D,SAAS,CAAEC,YAAY,CAAC,CAAG7D,QAAQ,CAAC,EAAE,CAAC,CAE9C,KAAM,CAAA8D,OAAO,CAAG,4DAA4D,CAE5E7D,SAAS,CAAC,IAAM,CACd8D,YAAY,CAAC,CAAC,CAChB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAA,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/BN,UAAU,CAAC,IAAI,CAAC,CAChB,GAAI,KAAAO,eAAA,CACF,KAAM,CAAEC,gBAAiB,CAAC,CAAG,KAAM,OAAM,CAAC,kBAAkB,CAAC,CAC7D,KAAM,CAAEC,MAAO,CAAC,CAAG,KAAM,CAAAD,gBAAgB,CAAC,CAAC,CAC3C,KAAM,CAAAE,OAAO,CAAGD,MAAM,SAANA,MAAM,kBAAAF,eAAA,CAANE,MAAM,CAAEC,OAAO,UAAAH,eAAA,iBAAfA,eAAA,CAAiBI,QAAQ,CAAC,CAAC,CAE3C,GAAI,CAACD,OAAO,CAAE,CACZ,KAAM,IAAI,CAAAE,KAAK,CAAC,oCAAoC,CAAC,CACvD,CAEA,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAC,KAAK,IAAA7C,MAAA,CAAIoC,OAAO,kBAAiB,CACjDU,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClCC,aAAa,WAAAhD,MAAA,CAAYyC,OAAO,CAClC,CACF,CAAC,CAAC,CAEF,GAAI,CAACG,GAAG,CAACK,EAAE,CAAE,CACX,KAAM,IAAI,CAAAN,KAAK,kBAAA3C,MAAA,CAAkB4C,GAAG,CAACM,MAAM,CAAE,CAAC,CAChD,CAEA,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAP,GAAG,CAACQ,IAAI,CAAC,CAAC,CAC7B,KAAM,CAAAC,QAAQ,CAAGC,oBAAoB,CAACH,IAAI,CAACI,OAAO,EAAI,CAAC,CAAC,CAAE5B,cAAc,CAAC,CACzEE,aAAa,CAACwB,QAAQ,CAAC,CACvBpB,QAAQ,CAAC,EAAE,CAAC,CACd,CAAE,MAAOuB,GAAG,CAAE,CACZC,OAAO,CAACzB,KAAK,CAAC,yBAAyB,CAAEwB,GAAG,CAAC,CAC7CvB,QAAQ,CAAC,yBAAyB,CAAC,CACrC,CAAC,OAAS,CACRF,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED;AACA,KAAM,CAAAuB,oBAAoB,CAAG,QAAAA,CAACC,OAAO,CAA6B,IAA3B,CAAA5B,cAAc,CAAA+B,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,KAAK,CAC3D,KAAM,CAAAL,QAAQ,CAAG,EAAE,CAEnB;AACA,CAAC,QAAQ,CAAE,OAAO,CAAE,OAAO,CAAE,OAAO,CAAC,CAACQ,OAAO,CAACC,QAAQ,EAAI,CACxD,GAAIP,OAAO,CAACO,QAAQ,CAAC,EAAIC,KAAK,CAACC,OAAO,CAACT,OAAO,CAACO,QAAQ,CAAC,CAAC,CAAE,CACzDP,OAAO,CAACO,QAAQ,CAAC,CAACD,OAAO,CAACI,IAAI,EAAI,CAChC,KAAM,CAAAC,SAAS,CAAGC,aAAa,CAACF,IAAI,CAACG,IAAI,EAAI,CAAC,CAAC,CAAC,CAEhD,KAAM,CAAAC,eAAe,CAAG,CACtBvF,GAAG,CAAEmF,IAAI,CAACnF,GAAG,CACbwF,SAAS,CAAEL,IAAI,CAACK,SAAS,CACzBC,OAAO,CAAEN,IAAI,CAACM,OAAO,CACrBH,IAAI,CAAEF,SAAS,CACfM,UAAU,CAAEP,IAAI,CAACG,IAAI,EAAI,CAAC,CAC5B,CAAC,CAED;AACA,GAAIzC,cAAc,CAAE,CAClB,KAAM,CAAA8C,WAAW,CAAG,CAACR,IAAI,CAACK,SAAS,EAAI,EAAE,EAAE9E,WAAW,CAAC,CAAC,CACxD,KAAM,CAAAkF,MAAM,CAAG,CAACT,IAAI,CAACnF,GAAG,EAAI,EAAE,EAAEU,WAAW,CAAC,CAAC,CAE7C;AACA,KAAM,CAAAmF,OAAO,CAAGF,WAAW,CAACG,UAAU,CAAC,QAAQ,CAAC,EACjCF,MAAM,CAACjF,QAAQ,CAAC,MAAM,CAAC,EAAIiF,MAAM,CAACjF,QAAQ,CAAC,OAAO,CAAC,EACnDiF,MAAM,CAACjF,QAAQ,CAAC,MAAM,CAAC,EAAIiF,MAAM,CAACjF,QAAQ,CAAC,MAAM,CAAC,EAClDiF,MAAM,CAACjF,QAAQ,CAAC,OAAO,CAAC,EAAIiF,MAAM,CAACjF,QAAQ,CAAC,MAAM,CAAC,EACnDiF,MAAM,CAACjF,QAAQ,CAAC,cAAc,CAAC,CAAE;AAEhD,GAAIkF,OAAO,CAAE,CACXtB,QAAQ,CAACwB,IAAI,CAACR,eAAe,CAAC,CAChC,CACF,CAAC,IAAM,CACL;AACAhB,QAAQ,CAACwB,IAAI,CAACR,eAAe,CAAC,CAChC,CACF,CAAC,CAAC,CACJ,CACF,CAAC,CAAC,CAEF,MAAO,CAAAhB,QAAQ,CACjB,CAAC,CAED,KAAM,CAAAc,aAAa,CAAIK,UAAU,EAAK,CACpC,GAAI,CAACA,UAAU,EAAI,MAAO,CAAAA,UAAU,GAAK,QAAQ,CAAE,CACjD,MAAO,EAAE,CACX,CAEA,MAAO,CAAAM,MAAM,CAACC,OAAO,CAACP,UAAU,CAAC,CAACpD,GAAG,CAAC4D,KAAA,EAAsB,IAArB,CAACC,OAAO,CAAEC,KAAK,CAAC,CAAAF,KAAA,CACrD,MAAO,CAAAE,KAAK,CAAG,CAAC,IAAAlF,MAAA,CAAMiF,OAAO,OAAAjF,MAAA,CAAKkF,KAAK,MAAMD,OAAO,CACtD,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAE,oBAAoB,CAAIrG,GAAG,EAAK,CACpC2C,iBAAiB,CAAC3C,GAAG,CAAC,CACtB4C,OAAO,CAAC,CAAC,CACX,CAAC,CAED,KAAM,CAAA0D,aAAa,CAAGlD,SAAS,CAC3BN,UAAU,CAACyD,MAAM,CAAEpB,IAAI,EAAK,KAAAqB,UAAA,CAC1B,KAAM,CAAAC,WAAW,CAAGrD,SAAS,CAAC1C,WAAW,CAAC,CAAC,CAE3C,KAAM,CAAAgG,kBAAkB,EAAAF,UAAA,CAAGrB,IAAI,CAACG,IAAI,UAAAkB,UAAA,iBAATA,UAAA,CAAWG,IAAI,CAACC,GAAG,EAC5CA,GAAG,CAAClG,WAAW,CAAC,CAAC,CAACC,QAAQ,CAAC8F,WAAW,CACxC,CAAC,CAED,KAAM,CAAAI,mBAAmB,CAAGb,MAAM,CAACc,IAAI,CAAC3B,IAAI,CAACO,UAAU,EAAI,CAAC,CAAC,CAAC,CAACiB,IAAI,CAACR,OAAO,EACzEA,OAAO,CAACzF,WAAW,CAAC,CAAC,CAACC,QAAQ,CAAC8F,WAAW,CAC5C,CAAC,CAED,MAAO,CAAAC,kBAAkB,EAAIG,mBAAmB,CAClD,CAAC,CAAC,CACF/D,UAAU,CAEd,mBACEnD,IAAA,QAAKwB,SAAS,CAAC,eAAe,CAAAQ,QAAA,cAC5B9B,KAAA,QAAKsB,SAAS,CAAC,eAAe,CAAAQ,QAAA,eAE5B9B,KAAA,QAAKsB,SAAS,CAAC,cAAc,CAAAQ,QAAA,eAC3BhC,IAAA,OAAAgC,QAAA,CACGkB,cAAc,CACX,8CAA8C,CAC9C,uCAAuC,CAEzC,CAAC,cACLlD,IAAA,WACE2B,OAAO,CAAEsB,OAAQ,CACjBzB,SAAS,CAAC,gBAAgB,CAAAQ,QAAA,CAC3B,OAED,CAAQ,CAAC,EACN,CAAC,cAGN9B,KAAA,QAAKsB,SAAS,CAAC,cAAc,CAAAQ,QAAA,eAC3BhC,IAAA,UACEoH,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,2BAA2B,CACvCC,KAAK,CAAE7D,SAAU,CACjB8D,QAAQ,CAAGhF,CAAC,EAAKmB,YAAY,CAACnB,CAAC,CAACC,MAAM,CAAC8E,KAAK,CAAE,CAC/C,CAAC,CACDpE,cAAc,eACbhD,KAAA,QAAKsB,SAAS,CAAC,YAAY,CAAAQ,QAAA,EAAC,kEAE1B,cAAAhC,IAAA,QAAK,CAAC,SACA,CAAC2G,aAAa,CAACzB,MAAM,CAAC,QAAM,CAACyB,aAAa,CAACzB,MAAM,GAAK,CAAC,CAAG,GAAG,CAAG,EAAE,EACrE,CACN,EACE,CAAC,CAGL3B,KAAK,eACJvD,IAAA,QAAKwB,SAAS,CAAC,eAAe,CAAAQ,QAAA,CAC3BuB,KAAK,CACH,CACN,CAGAF,OAAO,eACNrD,IAAA,QAAKwB,SAAS,CAAC,iBAAiB,CAAAQ,QAAA,CAAC,oBAEjC,CAAK,CACN,cAGDhC,IAAA,QAAKwB,SAAS,CAAC,iBAAiB,CAAAQ,QAAA,CAC7B2E,aAAa,CAAChE,GAAG,CAAC,CAAC6C,IAAI,CAAElF,KAAK,gBAC7BJ,KAAA,QAEEsB,SAAS,CAAC,gBAAgB,CAC1BG,OAAO,CAAEA,CAAA,GAAM+E,oBAAoB,CAAClB,IAAI,CAACnF,GAAG,CAAE,CAAA2B,QAAA,eAG9ChC,IAAA,QACEqB,GAAG,CAAEmE,IAAI,CAACnF,GAAI,CACdiB,GAAG,CAAC,WAAW,CACfE,SAAS,CAAC,iBAAiB,CAC3BI,OAAO,CAAGW,CAAC,EAAK,CACd;AACAA,CAAC,CAACC,MAAM,CAACf,KAAK,CAAC+F,OAAO,CAAG,MAAM,CAC/BjF,CAAC,CAACC,MAAM,CAACiF,kBAAkB,CAAChG,KAAK,CAAC+F,OAAO,CAAG,MAAM,CACpD,CAAE,CACH,CAAC,cAGFtH,KAAA,QAAKsB,SAAS,CAAC,oBAAoB,CAAAQ,QAAA,eACjChC,IAAA,QAAKQ,KAAK,CAAC,IAAI,CAACkB,MAAM,CAAC,IAAI,CAACO,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAAAF,QAAA,cACzDhC,IAAA,SAAMmC,CAAC,CAAC,yFAAyF,CAAC,CAAC,CAChG,CAAC,cACNnC,IAAA,SAAMwB,SAAS,CAAC,iCAAiC,CAAAQ,QAAA,CAC9CwD,IAAI,CAACK,SAAS,EAAI,MAAM,CACrB,CAAC,EACJ,CAAC,CAGLL,IAAI,CAACG,IAAI,EAAIH,IAAI,CAACG,IAAI,CAACT,MAAM,CAAG,CAAC,eAChChF,KAAA,QAAKsB,SAAS,CAAC,gBAAgB,CAAAQ,QAAA,EAC5BwD,IAAI,CAACG,IAAI,CAAC+B,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAChCnC,IAAI,CAACG,IAAI,CAACT,MAAM,CAAG,CAAC,EAAI,KAAK,EAC3B,CACN,GAhCIM,IAAI,CAACM,OAAO,EAAIxF,KAiClB,CACN,CAAC,CACC,CAAC,CAELqG,aAAa,CAACzB,MAAM,GAAK,CAAC,EAAI,CAAC7B,OAAO,eACrCrD,IAAA,MAAGwB,SAAS,CAAC,YAAY,CAAAQ,QAAA,CACtBkB,cAAc,CACX,kFAAkF,CAClF,0BAA0B,CAE7B,CACJ,EACE,CAAC,CACH,CAAC,CAEV,CAAC,CAED;AACA,KAAM,CAAA0E,MAAM,CAAGC,KAAA,EAA0D,IAAzD,CAAEC,uBAAuB,CAAEC,uBAAwB,CAAC,CAAAF,KAAA,CAClE,KAAM,CAAClC,IAAI,CAAEqC,OAAO,CAAC,CAAGnI,QAAQ,CAAC,CAAC,CAAEoH,GAAG,CAAE,EAAE,CAAER,KAAK,CAAE,CAAE,CAAC,CAAC,CAAC,CACzD,KAAM,CAACwB,WAAW,CAAEC,cAAc,CAAC,CAAGrI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CACpD,KAAM,CAACsI,QAAQ,CAAEC,WAAW,CAAC,CAAGvI,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACwI,SAAS,CAAEC,YAAY,CAAC,CAAGzI,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAAC0I,OAAO,CAAEC,UAAU,CAAC,CAAG3I,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACwD,OAAO,CAAEC,UAAU,CAAC,CAAGzD,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAC0D,KAAK,CAAEC,QAAQ,CAAC,CAAG3D,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAAC4I,gBAAgB,CAAEC,mBAAmB,CAAC,CAAG7I,QAAQ,CAAC,EAAE,CAAC,CAC5D,KAAM,CAAC8I,qBAAqB,CAAEC,wBAAwB,CAAC,CAAG/I,QAAQ,CAAC,KAAK,CAAC,CAEzE,KAAM,CAAA8D,OAAO,CAAG,4DAA4D,CAE5E;AACA,KAAM,CAAAkF,gBAAgB,CAAG,KAAO,CAAAC,QAAQ,EAAK,CAC3C,GAAI,KAAAC,gBAAA,CACFzF,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,EAAE,CAAC,CAEZ,KAAM,CAAEM,gBAAiB,CAAC,CAAG,KAAM,OAAM,CAAC,mBAAmB,CAAC,CAC9D,KAAM,CAAEC,MAAO,CAAC,CAAG,KAAM,CAAAD,gBAAgB,CAAC,CAAC,CAC3C,KAAM,CAAAkF,KAAK,CAAGjF,MAAM,SAANA,MAAM,kBAAAgF,gBAAA,CAANhF,MAAM,CAAEC,OAAO,UAAA+E,gBAAA,iBAAfA,gBAAA,CAAiB9E,QAAQ,CAAC,CAAC,CAEzC,GAAI,CAAC+E,KAAK,CAAE,CACV,KAAM,IAAI,CAAA9E,KAAK,CAAC,oCAAoC,CAAC,CACvD,CAEAc,OAAO,CAACiE,GAAG,CAAC,gBAAgB,CAAEH,QAAQ,CAAC,CAEvC;AACA,GAAIA,QAAQ,CAAC9H,QAAQ,CAAC,cAAc,CAAC,CAAE,CACrC;AACA,GAAI,CACF,KAAM,CAAAkI,QAAQ,CAAG,KAAM,CAAA9E,KAAK,IAAA7C,MAAA,CACvBoC,OAAO,4CAAApC,MAAA,CAA0C4H,kBAAkB,CAACL,QAAQ,CAAC,EAChF,CACEzE,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,eAAe,WAAA/C,MAAA,CAAYyH,KAAK,CAAE,CAClC,cAAc,CAAE,kBAClB,CACF,CACF,CAAC,CAED,GAAIE,QAAQ,CAAC1E,EAAE,CAAE,CACf,KAAM,CAAAE,IAAI,CAAG,KAAM,CAAAwE,QAAQ,CAACvE,IAAI,CAAC,CAAC,CAClC,GAAID,IAAI,CAAC0E,YAAY,CAAE,CACrBC,MAAM,CAACC,IAAI,CAAC5E,IAAI,CAAC0E,YAAY,CAAE,QAAQ,CAAC,CACxC,OACF,CACF,CACF,CAAE,MAAOrE,GAAG,CAAE,CACZC,OAAO,CAACzB,KAAK,CAAC,qCAAqC,CAAEwB,GAAG,CAAC,CAC3D,CAEA;AACA,KAAM,CAAAjD,WAAW,CAAGgH,QAAQ,CAAC/G,OAAO,CAAC,cAAc,CAAE,GAAG,CAAC,CACzDsH,MAAM,CAACC,IAAI,CAACxH,WAAW,CAAE,QAAQ,CAAC,CACpC,CAAC,IAAM,CACL;AACAuH,MAAM,CAACC,IAAI,CAACR,QAAQ,CAAE,QAAQ,CAAC,CACjC,CACF,CAAE,MAAO/D,GAAG,CAAE,CACZC,OAAO,CAACzB,KAAK,CAAC,qBAAqB,CAAEwB,GAAG,CAAC,CACzCvB,QAAQ,yBAAAjC,MAAA,CAAyBwD,GAAG,CAACwE,OAAO,CAAE,CAAC,CACjD,CAAC,OAAS,CACRjG,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAkG,eAAe,CAAGA,CAAClJ,KAAK,CAAEmJ,KAAK,CAAEnC,KAAK,GAAK,CAC/C,KAAM,CAAAoC,OAAO,CAAG,CAAC,GAAG/D,IAAI,CAAC,CACzB+D,OAAO,CAACpJ,KAAK,CAAC,CAACmJ,KAAK,CAAC,CAAGA,KAAK,GAAK,OAAO,CAAGE,QAAQ,CAACrC,KAAK,CAAC,CAAGA,KAAK,CAACvG,WAAW,CAAC,CAAC,CACjFiH,OAAO,CAAC0B,OAAO,CAAC,CAClB,CAAC,CAED,KAAM,CAAAE,WAAW,CAAGA,CAAA,GAAM5B,OAAO,CAAC,CAAC,GAAGrC,IAAI,CAAE,CAAEsB,GAAG,CAAE,EAAE,CAAER,KAAK,CAAE,CAAE,CAAC,CAAC,CAAC,CACnE,KAAM,CAAAoD,cAAc,CAAIvJ,KAAK,EAAK0H,OAAO,CAACrC,IAAI,CAACiB,MAAM,CAAC,CAACkD,CAAC,CAAElH,CAAC,GAAKA,CAAC,GAAKtC,KAAK,CAAC,CAAC,CAE7E,KAAM,CAAAyJ,QAAQ,CAAG,cAAAA,CAAO1J,GAAG,CAAE2J,OAAO,CAAqB,IAAnB,CAAAC,MAAM,CAAAhF,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,KAAK,CAClD3B,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,EAAE,CAAC,CACZgF,UAAU,CAAC,EAAE,CAAC,CAEd,GAAI,KAAA0B,gBAAA,CACF,KAAM,CAAEpG,gBAAiB,CAAC,CAAG,KAAM,OAAM,CAAC,mBAAmB,CAAC,CAC9D,KAAM,CAAEC,MAAO,CAAC,CAAG,KAAM,CAAAD,gBAAgB,CAAC,CAAC,CAC3C,KAAM,CAAAkF,KAAK,CAAGjF,MAAM,SAANA,MAAM,kBAAAmG,gBAAA,CAANnG,MAAM,CAAEC,OAAO,UAAAkG,gBAAA,iBAAfA,gBAAA,CAAiBjG,QAAQ,CAAC,CAAC,CAEzC,GAAI,CAAC+E,KAAK,CAAE,CACV,KAAM,IAAI,CAAA9E,KAAK,CAAC,oCAAoC,CAAC,CACvD,CAEA,KAAM,CAAAI,OAAO,CAAA6F,aAAA,EACX,eAAe,WAAA5I,MAAA,CAAYyH,KAAK,CAAE,EAC9BiB,MAAM,CAAG,CAAC,CAAC,CAAG,CAAE,cAAc,CAAE,kBAAmB,CAAC,CACzD,CAED,KAAM,CAAAf,QAAQ,CAAG,KAAM,CAAA9E,KAAK,CAAC/D,GAAG,CAAE,CAChCgE,MAAM,CAAE,MAAM,CACdC,OAAO,CACP8F,IAAI,CAAEH,MAAM,CAAGD,OAAO,CAAGK,IAAI,CAACC,SAAS,CAACN,OAAO,CACjD,CAAC,CAAC,CAEF,GAAI,CAACd,QAAQ,CAAC1E,EAAE,CAAE,CAChB,KAAM,CAAA+F,SAAS,CAAG,KAAM,CAAArB,QAAQ,CAACsB,IAAI,CAAC,CAAC,CACvC,KAAM,IAAI,CAAAtG,KAAK,UAAA3C,MAAA,CAAU2H,QAAQ,CAACzE,MAAM,OAAAlD,MAAA,CAAKgJ,SAAS,CAAE,CAAC,CAC3D,CAEA,KAAM,CAAA7F,IAAI,CAAG,KAAM,CAAAwE,QAAQ,CAACvE,IAAI,CAAC,CAAC,CAClC6D,UAAU,CAAC9D,IAAI,CAAC+F,KAAK,EAAI,EAAE,CAAC,CAC9B,CAAE,MAAO1F,GAAG,CAAE,CACZC,OAAO,CAACzB,KAAK,CAAC,iBAAiB,CAAEwB,GAAG,CAAC,CACrCvB,QAAQ,CAACuB,GAAG,CAACwE,OAAO,CAAC,CACvB,CAAC,OAAS,CACRjG,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAoH,OAAO,CAAG,KAAO,CAAArK,GAAG,EAAK,CAC7BiD,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,EAAE,CAAC,CACZgF,UAAU,CAAC,EAAE,CAAC,CAEd,GAAI,KAAAmC,gBAAA,CACF,KAAM,CAAE7G,gBAAiB,CAAC,CAAG,KAAM,OAAM,CAAC,mBAAmB,CAAC,CAC9D,KAAM,CAAEC,MAAO,CAAC,CAAG,KAAM,CAAAD,gBAAgB,CAAC,CAAC,CAC3C,KAAM,CAAAkF,KAAK,CAAGjF,MAAM,SAANA,MAAM,kBAAA4G,gBAAA,CAAN5G,MAAM,CAAEC,OAAO,UAAA2G,gBAAA,iBAAfA,gBAAA,CAAiB1G,QAAQ,CAAC,CAAC,CAEzC,GAAI,CAAC+E,KAAK,CAAE,CACV,KAAM,IAAI,CAAA9E,KAAK,CAAC,oCAAoC,CAAC,CACvD,CAEA,KAAM,CAAAgF,QAAQ,CAAG,KAAM,CAAA9E,KAAK,CAAC/D,GAAG,CAAE,CAChCgE,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,eAAe,WAAA/C,MAAA,CAAYyH,KAAK,CAAE,CAClC,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,CAEF,GAAI,CAACE,QAAQ,CAAC1E,EAAE,CAAE,CAChB,KAAM,CAAA+F,SAAS,CAAG,KAAM,CAAArB,QAAQ,CAACsB,IAAI,CAAC,CAAC,CACvC,KAAM,IAAI,CAAAtG,KAAK,UAAA3C,MAAA,CAAU2H,QAAQ,CAACzE,MAAM,OAAAlD,MAAA,CAAKgJ,SAAS,CAAE,CAAC,CAC3D,CAEA,KAAM,CAAA7F,IAAI,CAAG,KAAM,CAAAwE,QAAQ,CAACvE,IAAI,CAAC,CAAC,CAClC6D,UAAU,CAAC9D,IAAI,CAAC+F,KAAK,EAAI,EAAE,CAAC,CAC9B,CAAE,MAAO1F,GAAG,CAAE,CACZC,OAAO,CAACzB,KAAK,CAAC,gBAAgB,CAAEwB,GAAG,CAAC,CACpCvB,QAAQ,CAACuB,GAAG,CAACwE,OAAO,CAAC,CACvB,CAAC,OAAS,CACRjG,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAsH,gBAAgB,CAAGA,CAAA,GAAM,CAC7B,KAAM,CAAAC,KAAK,CAAGxE,MAAM,CAACyE,WAAW,CAACnF,IAAI,CAAChD,GAAG,CAACoI,KAAA,MAAC,CAAE9D,GAAG,CAAER,KAAM,CAAC,CAAAsE,KAAA,OAAK,CAAC9D,GAAG,CAAER,KAAK,CAAC,GAAC,CAAC,CAC5EsD,QAAQ,IAAAxI,MAAA,CAAIoC,OAAO,oBAAmBkH,KAAK,CAAC,CAC9C,CAAC,CAED,KAAM,CAAAG,eAAe,CAAGA,CAAA,GAAM,CAC5B,GAAI/C,WAAW,CAAC/C,MAAM,GAAK,CAAC,EAAI+C,WAAW,CAACgD,KAAK,CAACC,CAAC,EAAI,CAACA,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CAAE,CACjE3H,QAAQ,CAAC,wCAAwC,CAAC,CAClD,OACF,CAEA,KAAM,CAAA4H,WAAW,CAAGnD,WAAW,CAC5BrB,MAAM,CAACsE,CAAC,EAAIA,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CACrBxI,GAAG,CAAC,CAACuI,CAAC,CAAEtI,CAAC,aAAArB,MAAA,CAAe0G,WAAW,CAAC/C,MAAM,CAAG,CAAC,CAAGtC,CAAC,CAAG,CAAC,CAAG,EAAE,MAAArB,MAAA,CAAI4H,kBAAkB,CAAC+B,CAAC,CAAC,CAAE,CAAC,CACvFvD,IAAI,CAAC,GAAG,CAAC,CAEZ,KAAM,CAAA0D,OAAO,IAAA9J,MAAA,CAAMoC,OAAO,iCAAApC,MAAA,CAA+B6J,WAAW,CAAE,CACtEV,OAAO,CAACW,OAAO,CAAC,CAClB,CAAC,CAED,KAAM,CAAAC,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CAACjD,SAAS,CAAE,CACd7E,QAAQ,CAAC,4BAA4B,CAAC,CACtC,OACF,CACAF,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,EAAE,CAAC,CACZgF,UAAU,CAAC,EAAE,CAAC,CACdE,mBAAmB,CAAC,uBAAuB,CAAC,CAC5C,GAAI,KAAA6C,gBAAA,CACF,KAAM,CAAEzH,gBAAiB,CAAC,CAAG,KAAM,OAAM,CAAC,mBAAmB,CAAC,CAC9D,KAAM,CAAEC,MAAO,CAAC,CAAG,KAAM,CAAAD,gBAAgB,CAAC,CAAC,CAC3C,KAAM,CAAAkF,KAAK,CAAGjF,MAAM,SAANA,MAAM,kBAAAwH,gBAAA,CAANxH,MAAM,CAAEC,OAAO,UAAAuH,gBAAA,iBAAfA,gBAAA,CAAiBtH,QAAQ,CAAC,CAAC,CACzC;AACAyE,mBAAmB,CAAC,uBAAuB,CAAC,CAC5C,KAAM,CAAA8C,cAAc,CAAG,KAAM,CAAApH,KAAK,IAAA7C,MAAA,CAAIoC,OAAO,YAAW,CACtDU,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,eAAe,WAAA/C,MAAA,CAAYyH,KAAK,CAAE,CAClC,cAAc,CAAE,kBAClB,CAAC,CACDoB,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBmB,QAAQ,CAAEpD,SAAS,CAACqD,IAAI,CACxBrG,QAAQ,CAAEgD,SAAS,CAACjB,IAAI,CACxBuE,SAAS,CAAE,IAAM;AACnB,CAAC,CACH,CAAC,CAAC,CACF,GAAI,CAACH,cAAc,CAAChH,EAAE,CAAE,CACtB,KAAM,CAAAjB,KAAK,CAAG,KAAM,CAAAiI,cAAc,CAAC7G,IAAI,CAAC,CAAC,CACzC,KAAM,IAAI,CAAAT,KAAK,CAACX,KAAK,CAACA,KAAK,EAAI,0BAA0B,CAAC,CAC5D,CACA,KAAM,CAAAqI,UAAU,CAAG,KAAM,CAAAJ,cAAc,CAAC7G,IAAI,CAAC,CAAC,CAC9CK,OAAO,CAACiE,GAAG,CAAC,uBAAuB,CAAE2C,UAAU,CAAC,CAEhD;AACA,GAAI,CAACA,UAAU,CAACC,KAAK,CAAE,CACrB,KAAM,IAAI,CAAA3H,KAAK,CAAC,+BAA+B,CAAC,CAClD,CAEA;AACAwE,mBAAmB,CAAC,gCAAgC,CAAC,CACrD,KAAM,CAAAoD,UAAU,CAAG,KAAM,CAAA1H,KAAK,CAACwH,UAAU,CAACG,SAAS,CAAE,CACnD1H,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CAAE,cAAc,CAAE+D,SAAS,CAACjB,IAAK,CAAC,CAC3CgD,IAAI,CAAE/B,SACR,CAAC,CAAC,CACF,GAAI,CAACyD,UAAU,CAACtH,EAAE,CAAE,CAClB,KAAM,IAAI,CAAAN,KAAK,CAAC,uBAAuB,CAAC,CAC1C,CAEA;AACAwE,mBAAmB,CAAC,yEAAyE,CAAC,CAE9F;AACA,KAAM,CAAAsD,aAAa,CAAG,CAAEH,KAAK,CAAED,UAAU,CAACC,KAAM,CAAC,CAEjD7G,OAAO,CAACiE,GAAG,CAAC,iBAAiB,CAAE+C,aAAa,CAAC,CAE7C,KAAM,CAAAC,cAAc,CAAG,KAAM,CAAA7H,KAAK,IAAA7C,MAAA,CAAIoC,OAAO,wBAAuB,CAClEU,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,eAAe,WAAA/C,MAAA,CAAYyH,KAAK,CAAE,CAClC,cAAc,CAAE,kBAClB,CAAC,CACDoB,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC0B,aAAa,CACpC,CAAC,CAAC,CACF,GAAI,CAACC,cAAc,CAACzH,EAAE,CAAE,CACtB,KAAM,CAAA0H,SAAS,CAAG,KAAM,CAAAD,cAAc,CAACtH,IAAI,CAAC,CAAC,CAC7C,KAAM,IAAI,CAAAT,KAAK,CAACgI,SAAS,CAAC3I,KAAK,EAAI,eAAe,CAAC,CACrD,CACA,KAAM,CAAAgF,OAAO,CAAG,KAAM,CAAA0D,cAAc,CAACtH,IAAI,CAAC,CAAC,CAC3C;AACA6D,UAAU,CAACD,OAAO,CAACkC,KAAK,EAAI,EAAE,CAAC,CAC/B,KAAM,CAAA0B,SAAS,CAAG9F,MAAM,CAACc,IAAI,CAACoB,OAAO,CAAC6D,aAAa,EAAI,CAAC,CAAC,CAAC,CAACzE,IAAI,CAAC,IAAI,CAAC,CACrEe,mBAAmB,UAAAnH,MAAA,CAAUgH,OAAO,CAAC8D,WAAW,EAAI,CAAC,gCAAA9K,MAAA,CAA8B4K,SAAS,CAAE,CAAC,CACjG,CAAE,MAAOpH,GAAG,CAAE,CACZvB,QAAQ,CAACuB,GAAG,CAACwE,OAAO,CAAC,CACrBb,mBAAmB,CAAC,EAAE,CAAC,CACzB,CAAC,OAAS,CACRpF,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAgJ,qBAAqB,CAAIjM,GAAG,EAAK,CACrC;AACA,KAAM,CAAAkM,QAAQ,CAAGlM,GAAG,CAACmM,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAElC;AACA,GAAI,CAAAC,YAAY,CAAGF,QAAQ,CAC3B,GAAIA,QAAQ,CAACvL,QAAQ,CAAC,gBAAgB,CAAC,CAAE,CACvC;AACA,KAAM,CAAA0L,QAAQ,CAAGH,QAAQ,CAACC,KAAK,CAAC,GAAG,CAAC,CAACG,GAAG,CAAC,CAAC,CAC1C;AACAF,YAAY,2DAAAlL,MAAA,CAA6DmL,QAAQ,CAAE,CACrF,CAEAtE,WAAW,CAACqE,YAAY,CAAC,CACzB;AACA/B,OAAO,IAAAnJ,MAAA,CAAIoC,OAAO,4CAAApC,MAAA,CAA0C4H,kBAAkB,CAACsD,YAAY,CAAC,CAAE,CAAC,CACjG,CAAC,CAED,mBACEvM,KAAA,QAAKsB,SAAS,CAAC,kBAAkB,CAAAQ,QAAA,eAC/BhC,IAAA,OAAIwB,SAAS,CAAC,mBAAmB,CAAAQ,QAAA,CAAC,iBAAe,CAAI,CAAC,CAGrDuB,KAAK,eACJvD,IAAA,QAAKwB,SAAS,CAAC,eAAe,CAAAQ,QAAA,CAC3BuB,KAAK,CACH,CACN,cAGDrD,KAAA,YAASsB,SAAS,CAAC,gBAAgB,CAAAQ,QAAA,eACjChC,IAAA,OAAAgC,QAAA,CAAI,uBAAqB,CAAI,CAAC,CAC7B2D,IAAI,CAAChD,GAAG,CAAC,CAACiK,CAAC,CAAEhK,CAAC,gBACb1C,KAAA,QAAasB,SAAS,CAAC,eAAe,CAAAQ,QAAA,eACpChC,IAAA,UACEqH,WAAW,CAAC,kBAAkB,CAC9BC,KAAK,CAAEsF,CAAC,CAAC3F,GAAI,CACbM,QAAQ,CAAGhF,CAAC,EAAKiH,eAAe,CAAC5G,CAAC,CAAE,KAAK,CAAEL,CAAC,CAACC,MAAM,CAAC8E,KAAK,CAAE,CAC3D9F,SAAS,CAAC,WAAW,CACtB,CAAC,cACFxB,IAAA,UACEoH,IAAI,CAAC,QAAQ,CACbE,KAAK,CAAEsF,CAAC,CAACnG,KAAM,CACfc,QAAQ,CAAGhF,CAAC,EAAKiH,eAAe,CAAC5G,CAAC,CAAE,OAAO,CAAEL,CAAC,CAACC,MAAM,CAAC8E,KAAK,CAAE,CAC7D9F,SAAS,CAAC,aAAa,CACvBqL,GAAG,CAAC,GAAG,CACR,CAAC,CACDlH,IAAI,CAACT,MAAM,CAAG,CAAC,eACdlF,IAAA,WAAQ2B,OAAO,CAAEA,CAAA,GAAMkI,cAAc,CAACjH,CAAC,CAAE,CAACpB,SAAS,CAAC,6BAA6B,CAAAQ,QAAA,CAAC,QAElF,CAAQ,CACT,GAlBOY,CAmBL,CACN,CAAC,cACF5C,IAAA,WAAQ2B,OAAO,CAAEiI,WAAY,CAACpI,SAAS,CAAC,mBAAmB,CAAAQ,QAAA,CAAC,WAAS,CAAQ,CAAC,cAC9EhC,IAAA,WAAQ2B,OAAO,CAAEiJ,gBAAiB,CAACpJ,SAAS,CAAC,yBAAyB,CAACsL,QAAQ,CAAEzJ,OAAQ,CAAArB,QAAA,CAAC,QAE1F,CAAQ,CAAC,EACF,CAAC,cAGV9B,KAAA,YAASsB,SAAS,CAAC,gBAAgB,CAAAQ,QAAA,eACjChC,IAAA,OAAAgC,QAAA,CAAI,2BAAyB,CAAI,CAAC,CACjCiG,WAAW,CAACtF,GAAG,CAAC,CAACuI,CAAC,CAAEtI,CAAC,gBACpB1C,KAAA,QAAasB,SAAS,CAAC,eAAe,CAAAQ,QAAA,eACpChC,IAAA,UACEsH,KAAK,CAAE4D,CAAE,CACT7D,WAAW,YAAA9F,MAAA,CAAaqB,CAAC,CAAG,CAAC,CAAG,CAChC2E,QAAQ,CAAGhF,CAAC,EAAK,CACf,KAAM,CAAAwK,OAAO,CAAG,CAAC,GAAG9E,WAAW,CAAC,CAChC8E,OAAO,CAACnK,CAAC,CAAC,CAAGL,CAAC,CAACC,MAAM,CAAC8E,KAAK,CAACvG,WAAW,CAAC,CAAC,CACzCmH,cAAc,CAAC6E,OAAO,CAAC,CACzB,CAAE,CACFvL,SAAS,CAAC,eAAe,CAC1B,CAAC,CACDyG,WAAW,CAAC/C,MAAM,CAAG,CAAC,eACrBlF,IAAA,WACE2B,OAAO,CAAEA,CAAA,GAAMuG,cAAc,CAACD,WAAW,CAACrB,MAAM,CAAC,CAACkD,CAAC,CAAExJ,KAAK,GAAKA,KAAK,GAAKsC,CAAC,CAAC,CAAE,CAC7EpB,SAAS,CAAC,6BAA6B,CAAAQ,QAAA,CACxC,QAED,CAAQ,CACT,GAlBOY,CAmBL,CACN,CAAC,cACF5C,IAAA,WAAQ2B,OAAO,CAAEA,CAAA,GAAMuG,cAAc,CAAC,CAAC,GAAGD,WAAW,CAAE,EAAE,CAAC,CAAE,CAACzG,SAAS,CAAC,mBAAmB,CAAAQ,QAAA,CAAC,eAE3F,CAAQ,CAAC,cACThC,IAAA,WAAQ2B,OAAO,CAAEqJ,eAAgB,CAACxJ,SAAS,CAAC,yBAAyB,CAACsL,QAAQ,CAAEzJ,OAAQ,CAAArB,QAAA,CAAC,QAEzF,CAAQ,CAAC,EACF,CAAC,cAGV9B,KAAA,YAASsB,SAAS,CAAC,gBAAgB,CAAAQ,QAAA,eACjChC,IAAA,OAAAgC,QAAA,CAAI,sCAAoC,CAAI,CAAC,cAC7ChC,IAAA,MAAAgC,QAAA,CAAG,uDAEH,CAAG,CAAC,cAEJ9B,KAAA,QAAKsB,SAAS,CAAC,eAAe,CAAAQ,QAAA,eAC5BhC,IAAA,UACEsH,KAAK,CAAEa,QAAS,CAChBZ,QAAQ,CAAGhF,CAAC,EAAK6F,WAAW,CAAC7F,CAAC,CAACC,MAAM,CAAC8E,KAAK,CAAE,CAC7CD,WAAW,CAAC,4CAA4C,CACxD7F,SAAS,CAAC,WAAW,CACtB,CAAC,cAEFxB,IAAA,WACE2B,OAAO,CAAEA,CAAA,GAAMiH,wBAAwB,CAAC,IAAI,CAAE,CAC9CpH,SAAS,CAAC,iBAAiB,CAAAQ,QAAA,CAC5B,qBAED,CAAQ,CAAC,EACN,CAAC,CAGLmG,QAAQ,EAAIA,QAAQ,CAACnH,QAAQ,CAAC,gBAAgB,CAAC,eAC9Cd,KAAA,QAAKsB,SAAS,CAAC,uBAAuB,CAAAQ,QAAA,EAAC,mCACJ,CAACmG,QAAQ,CAACpG,OAAO,CAAC,gBAAgB,CAAE,oBAAoB,CAAC,EACvF,CACN,cAED/B,IAAA,WACE2B,OAAO,CAAEA,CAAA,GAAM,CACb,GAAI,CAACwG,QAAQ,CAACgD,IAAI,CAAC,CAAC,CAAE,CACpB3H,QAAQ,CAAC,qDAAqD,CAAC,CAC/D,OACF,CACA;AACA,GAAI,CAAA+I,QAAQ,CAAGpE,QAAQ,CAACqE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAErC;AACA,GAAID,QAAQ,CAACvL,QAAQ,CAAC,gBAAgB,CAAC,CAAE,CACvC,KAAM,CAAA0L,QAAQ,CAAGH,QAAQ,CAACC,KAAK,CAAC,GAAG,CAAC,CAACG,GAAG,CAAC,CAAC,CAC1CJ,QAAQ,2DAAAhL,MAAA,CAA6DmL,QAAQ,CAAE,CACjF,CAEAhC,OAAO,IAAAnJ,MAAA,CAAIoC,OAAO,4CAAApC,MAAA,CAA0C4H,kBAAkB,CAACoD,QAAQ,CAAC,CAAE,CAAC,CAC7F,CAAE,CACFO,QAAQ,CAAEzJ,OAAQ,CAClB7B,SAAS,CAAC,iBAAiB,CAAAQ,QAAA,CAC5B,iBAED,CAAQ,CAAC,EACF,CAAC,CAGT2G,qBAAqB,eACpB3I,IAAA,CAAC8C,iBAAiB,EAChBE,iBAAiB,CAAEsJ,qBAAsB,CACzCrJ,OAAO,CAAEA,CAAA,GAAM2F,wBAAwB,CAAC,KAAK,CAAE,CAC/C1F,cAAc,CAAE,IAAK,CACtB,CACF,cAGDhD,KAAA,YAASsB,SAAS,CAAC,gBAAgB,CAAAQ,QAAA,eACjChC,IAAA,OAAAgC,QAAA,CAAI,sCAAoC,CAAI,CAAC,cAC7ChC,IAAA,MAAGwB,SAAS,CAAC,QAAQ,CAAAQ,QAAA,CAAC,iEAEtB,CAAG,CAAC,cAEJhC,IAAA,UACEoH,IAAI,CAAC,MAAM,CACXG,QAAQ,CAAGhF,CAAC,EAAK+F,YAAY,CAAC/F,CAAC,CAACC,MAAM,CAACwK,KAAK,CAAC,CAAC,CAAC,CAAE,CACjDC,MAAM,CAAC,yBAAyB,CAChCH,QAAQ,CAAEzJ,OAAQ,CAClB7B,SAAS,CAAC,YAAY,CACvB,CAAC,cAEFxB,IAAA,WACE2B,OAAO,CAAE2J,YAAa,CACtBwB,QAAQ,CAAEzJ,OAAO,EAAI,CAACgF,SAAU,CAChC7G,SAAS,CAAC,yBAAyB,CAAAQ,QAAA,CAElCqB,OAAO,CAAG,eAAe,CAAG,oBAAoB,CAC3C,CAAC,CAGRoF,gBAAgB,eACfzI,IAAA,MAAGwB,SAAS,kBAAAD,MAAA,CAAmB8B,OAAO,CAAG,SAAS,CAAG,SAAS,CAAG,CAAArB,QAAA,CAC9DyG,gBAAgB,CAChB,CACJ,CAGAJ,SAAS,eACRnI,KAAA,MAAGsB,SAAS,CAAC,WAAW,CAAAQ,QAAA,EAAC,YACb,CAACqG,SAAS,CAACqD,IAAI,CAAC,IAAE,CAAC,CAACrD,SAAS,CAAC6E,IAAI,CAAG,IAAI,CAAG,IAAI,EAAEC,OAAO,CAAC,CAAC,CAAC,CAAC,MACvE,CAAC9E,SAAS,CAACjB,IAAI,CAACjB,UAAU,CAAC,QAAQ,CAAC,EAAI,6CAA6C,EACpF,CACJ,EACM,CAAC,cAGVjG,KAAA,YAASsB,SAAS,CAAC,gBAAgB,CAAAQ,QAAA,eACjChC,IAAA,OAAAgC,QAAA,CAAI,iBAAe,CAAI,CAAC,cACxBhC,IAAA,MAAAgC,QAAA,CAAG,4EAEH,CAAG,CAAC,cAEJhC,IAAA,WACE2B,OAAO,CAAEoG,uBAAwB,CACjCvG,SAAS,CAAC,0BAA0B,CAAAQ,QAAA,CACrC,2BAED,CAAQ,CAAC,EACF,CAAC,cAGV9B,KAAA,YAASsB,SAAS,CAAC,gBAAgB,CAAAQ,QAAA,eACjChC,IAAA,OAAAgC,QAAA,CAAI,wBAAsB,CAAI,CAAC,cAC/BhC,IAAA,MAAAgC,QAAA,CAAG,+EAEH,CAAG,CAAC,cAEJhC,IAAA,WACE2B,OAAO,CAAEmG,uBAAwB,CACjCtG,SAAS,CAAC,2BAA2B,CAAAQ,QAAA,CACtC,2BAED,CAAQ,CAAC,EACF,CAAC,cAGV9B,KAAA,YAASsB,SAAS,CAAC,iBAAiB,CAAAQ,QAAA,EACjCqB,OAAO,eACNrD,IAAA,QAAKwB,SAAS,CAAC,iBAAiB,CAAAQ,QAAA,CAAC,YAEjC,CAAK,CACN,CAEAuG,OAAO,CAACrD,MAAM,CAAG,CAAC,eACjBhF,KAAA,QAAA8B,QAAA,eACE9B,KAAA,OAAA8B,QAAA,EAAI,WAAS,CAACuG,OAAO,CAACrD,MAAM,CAAC,SAAO,EAAI,CAAC,cACzClF,IAAA,QAAKwB,SAAS,CAAC,cAAc,CAAAQ,QAAA,CAC1BuG,OAAO,CAAC5F,GAAG,CAAC,CAACmG,QAAQ,CAAElG,CAAC,gBACvB1C,KAAA,QAAasB,SAAS,CAAC,aAAa,CAAAQ,QAAA,eAClChC,IAAA,CAACG,cAAc,EACbE,GAAG,CAAEyI,QAAS,CACdxI,KAAK,CAAEsC,CAAE,CACTrC,YAAY,CAAEsI,gBAAiB,CAC/BrI,KAAK,CAAE,GAAI,CACZ,CAAC,cACFN,KAAA,QAAKsB,SAAS,CAAC,cAAc,CAAAQ,QAAA,EAAC,GAC3B,CAACY,CAAC,CAAG,CAAC,EACJ,CAAC,GATEA,CAUL,CACN,CAAC,CACC,CAAC,EACH,CACN,EACM,CAAC,EACP,CAAC,CAEV,CAAC,CAED,cAAe,CAAAgF,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}